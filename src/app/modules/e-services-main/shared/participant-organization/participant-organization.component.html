<div class="row">
  <div class="col-md-6 col-sm-12 mb-4 ">
    <label class="form-label"
           for="totalCost">{{lang.map.total_coordination_request_value}}</label>
    <input  [readonly]="true"
          [value]="calculateTotalParticipatingValue()"
            id="totalCost"
           class="form-control">
  </div>
</div>
<div class="row" *ngIf="canAdd">
  <div class="col-md-6 col-sm-12 mb-4">
    <label class="form-label" for="selectedOrg">{{lang.map.menu_organizations}}</label>
    <div style="display: flex">
      <ng-select #selectOrganizations appendTo="body" [clearable]="true" id="selectedOrg" ng-model="selectedOrg"
        style="flex: 1" (change)="onChangeRecord($event)"
        labelForId="selectedOrg"
        >
        <ng-option [value]="option.id" *ngFor="let option of organizationUnits"
        [disabled]="!canAdd"
        >{{option.getName()}}</ng-option>
      </ng-select>
      <button class="btn btn-link outline-none" style="padding: 0" tooltip="{{lang.map.btn_add}}" (click)="onSave()"
        [disabled]="allowAdd()">
        <i class="mdi mdi-plus-box"></i></button>
    </div>
  </div>
</div>

<table  cdk-table [dataSource]="listDataSource"
  class="table table-striped table-bordered caption-top">
  <ng-container cdkColumnDef="arName">
    <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.arabic_name}}</th>
    <td cdk-cell *cdkCellDef="let row"> {{row.arabicName}} </td>
  </ng-container>
  <ng-container cdkColumnDef="enName">
    <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.english_name}}</th>
    <td cdk-cell *cdkCellDef="let row"> {{row.englishName}} </td>
  </ng-container>
  <ng-container cdkColumnDef="value">
    <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.participating_value}}</th>
    <td cdk-cell *cdkCellDef="let row"> {{row.value }} </td>
  </ng-container><ng-container cdkColumnDef="managerDecisionInfo">
    <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.request_state}}</th>
    <td cdk-cell *cdkCellDef="let row"> {{row.managerDecisionInfo?.getName() }} </td>
  </ng-container>

  <ng-container cdkColumnDef="actions"  >
    <th [hidden]="!canView && !canDelete" cdk-header-cell *cdkHeaderCellDef> {{lang.map.lbl_actions}}</th>
    <td cdk-cell *cdkCellDef="let row;  let i = index " class="table-actions">
      <div class="d-flex flex-row">
        <button (click)="view($event, row)"
        [hidden]="!canView"
        tooltip="{{lang.map.view}}" class="btn btn-link outline-none">
          <i class="mdi mdi-eye"></i>
        </button>
        <button (click)="delete($event, row,i)"
        [hidden]="!canDelete"
        tooltip="{{lang.map.btn_remove}}" class="btn btn-link outline-none">
          <i class="mdi mdi-close-box"></i>
        </button>

      </div>
    </td>
  </ng-container>
  <tr cdk-header-row *cdkHeaderRowDef="model.DisplayedColumns"></tr>
  <tr cdk-row *cdkRowDef="let row; columns: model.DisplayedColumns;"></tr>

  <tr *cdkNoDataRow>
    <td colspan="100" class="text-center">{{lang.map.no_records_to_display}}</td>
  </tr>
</table>
