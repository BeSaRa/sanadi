<form class="row" [formGroup]="form" *ngIf="showForm">
  <div
    *ngFor="let control of controls"
    class="col-sm-6 col-md-4 mb-4 position-relative"
  >
    <ng-container *ngIf="!!control.load || !!control.load$; else normalInput">
      <div>
        <label
          [asteriskIfRequired]="control.controlName"
          for="requestType"
          class="form-label"
          >{{ control.label }}</label
        >
        <ng-select
          [selectOnTab]="true"
          [labelForId]="control.controlName"
          [clearable]="true"
          placeholder="{{ lang.map.select }}"
          [id]="control.controlName"
          [notFoundText]="lang.map.msg_not_found"
          appendTo="body"
          [validationClasses]="control.controlName"
          [formControlName]="control.controlName"
        >
          <ng-option
            *ngFor="let type of control.load$ | async"
            [value]="type.id"
            >{{ type.getName() }}</ng-option
          >
        </ng-select>
        <app-field-error-message
          [controlName]="control.controlName"
        ></app-field-error-message>
      </div>
    </ng-container>
    <ng-template #normalInput>
      <label
        [asteriskIfRequired]="control.controlName"
        [for]="control.controlName"
        class="form-label"
        [validationClasses]="control.controlName"
        >{{ control.label }}</label
      >
      <input
        type="text"
        class="form-control"
        [id]="control.controlName"
        [formControlName]="control.controlName"
      />

      <app-field-error-message
        [controlName]="control.controlName"
      ></app-field-error-message>
    </ng-template>
  </div>
  <div class="col-sm-6 col-md-4 mb-4 position-relative">
    <label
      asteriskIfRequired="joinDate"
      for="joinDate"
      class="form-label"
      validationClasses="joinDate"
      >{{ lang.map.date }}</label
    >
    <div class="input-group">
      <i class="input-group-text mdi mdi-calendar"></i>
      <div
        class="form-control"
        formControlName="joinDate"
        [ngClass]="{ 'input-disabled': readonly }"
        id="joinDate"
        [options]="datepickerOptionsMap.joinDate"
        (click)="!readonly && dpjoinDate.toggleCalendar()"
        #dpjoinDate="angular-mydatepicker"
        angular-mydatepicker
        validationClasses="joinDate"
      ></div>
      <app-field-error-message controlName="joinDate"></app-field-error-message>
    </div>
  </div>
  <div class="d-flex flex-row align-items-center justify-content-center">
    <button
      (click)="save()"
      [disabled]="readonly"
      *ngIf="!readonly"
      class="btn btn-primary m-2"
    >
      {{ editRecordIndex > -1 ? lang.map.btn_save : lang.map.btn_add }}
    </button>
    <button (click)="cancel()" class="btn btn-secondary m-2">
      {{ lang.map.btn_cancel }}
    </button>
  </div>
</form>

<app-page-header
  [hidden]="showForm"
  [pageTitle]="pageTitle"
  [clickOnNew$]="add$"
  [addPermission]="!readonly"
></app-page-header>

<div class="row">
  <div class="col-12">
    <app-table
      #table
      [useSearchToFilter]="true"
      [selectable]="true"
      [data]="_list"
      [columns]="columns"
      sortableTable
    >
      <table
        cdk-table
        [dataSource]="table.dataSource"
        class="table table-striped table-bordered caption-top"
      >
        <ng-container cdkColumnDef="fullName">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.full_name }}
          </th>
          <td cdk-cell *cdkCellDef="let row">{{ row.fullName }}</td>
        </ng-container>
        <ng-container cdkColumnDef="identificationNumber">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.personal_number }}
          </th>
          <td cdk-cell *cdkCellDef="let row">
            {{ row.identificationNumber }}
          </td>
        </ng-container>
        <ng-container cdkColumnDef="jobTitleId">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.job_title }}
          </th>
          <td cdk-cell *cdkCellDef="let row">{{ row.jobTitleId }}</td>
        </ng-container>
        <ng-container *ngIf="extended" cdkColumnDef="joinDate">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.date }}
          </th>
          <td cdk-cell *cdkCellDef="let row">{{ row.joinDate | date }}</td>
        </ng-container>
        <ng-container *ngIf="extended" cdkColumnDef="email">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.lbl_email }}
          </th>
          <td cdk-cell *cdkCellDef="let row">{{ row.email }}</td>
        </ng-container>
        <ng-container *ngIf="extended" cdkColumnDef="phone">
          <th cdk-header-cell sortable-header *cdkHeaderCellDef>
            {{ lang.map.lbl_phone }}
          </th>
          <td cdk-cell *cdkCellDef="let row">{{ row.phone }}</td>
        </ng-container>

        <ng-container cdkColumnDef="actions">
          <th cdk-header-cell *cdkHeaderCellDef>
            {{ lang.map.lbl_actions }}
          </th>
          <td cdk-cell *cdkCellDef="let row" class="table-actions">
            <!-- <div class="d-flex flex-row">
              <button
                (click)="removeOfficer($event, row)"
                tooltip="{{ lang.map.btn_remove }}"
                class="btn btn-link outline-none"
                [disabled]="readonly"
              >
                <i class="mdi mdi-close-box"></i>
              </button>
              <button
                (click)="selectOfficer($event, row)"
                tooltip="{{ lang.map.btn_edit }}"
                class="btn btn-link outline-none"
                [disabled]="readonly"
              >
                <i class="mdi mdi-pen"></i>
              </button>
            </div> -->
          </td>
        </ng-container>
        <tr cdk-header-row *cdkHeaderRowDef="columns"></tr>
        <tr cdk-row *cdkRowDef="let row; columns: columns"></tr>
        <tr *cdkNoDataRow>
          <td colspan="100" class="text-center">
            {{ lang.map.no_records_to_display }}
          </td>
        </tr>
      </table>
    </app-table>
  </div>
</div>
