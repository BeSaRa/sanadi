<div class="row">
  <tabs-list [accordionView]="accordionView" [hasForm]="true" class="py-4" [tabByIndex$]="tabIndex$">
    <tab [name]="tabsData.basicInfo.name" [hasError]="getTabInvalidStatus('basicInfo')"
         [template]="basicInfoTab" [title]="lang.map.lbl_basic_info"></tab>
    <tab [name]="tabsData.projectCategory.name" [hasError]="getTabInvalidStatus('projectCategory')"
         [template]="categoryInfoTab" [title]="lang.map.project_category_info"></tab>
    <tab [name]="tabsData.projectSummary.name" [hasError]="getTabInvalidStatus('projectSummary')"
         [template]="summaryInfoTab" [title]="lang.map.project_summary_info"></tab>
    <tab [name]="tabsData.projectComponentsAndBudget.name"
         [hasError]="getTabInvalidStatus('projectComponentsAndBudget')"
         [template]="componentsBudgetsTab" [title]="lang.map.project_components_budgets"></tab>
    <tab [name]="tabsData.evaluationIndicators.name"
         [hasError]="getTabInvalidStatus('evaluationIndicators')"
         [template]="evaluationIndicatorsTab" [title]="lang.map.project_evaluation_indicators"></tab>
    <tab [name]="tabsData.projectAddresses.name"
         [hasError]="getTabInvalidStatus('projectAddresses')"
         [template]="projectAddressesTab" [title]="lang.map.project_addresses"
         *ngIf="showProjectAddressesTab"></tab>
    <tab [name]="tabsData.foreignCountriesProjects.name"
         [hasError]="getTabInvalidStatus('foreignCountriesProjects')"
         [template]="foreignCountriesProjectsTab" [title]="lang.map.project_model_foreign_countries_projects"
         *ngIf="isOutsideQatarProject()"></tab>
    <tab [name]="tabsData.specialExplanations.name" [hasError]="getTabInvalidStatus('specialExplanations')"
         [template]="specialExplanationTab" [title]="lang.map.special_explanations"></tab>
    <tab [name]="tabsData.comments.name" [hasError]="getTabInvalidStatus('comments')"
         [template]="commentsTabTemplate" [title]="lang.map.comments"
         *ngIf="employeeService.isInternalUser()"></tab>
    <tab *ngIf="!accordionView" [hideIcon]="true" [name]="tabsData.attachments.name" [hasError]="getTabInvalidStatus('attachments')"
         [template]="attachmentsTab" [title]="lang.map.attachments"></tab>
  </tabs-list>
</div>
<ng-container [formGroup]="form">
  <ng-template #basicInfoTab>
    <ng-container formGroupName="basicInfo">
      <fieldset [disabled]="readonly">
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="requestType"
                   for="requestType">{{lang.map.request_type}}</label>
            <ng-select (change)="handleRequestTypeChange($event, true)" [readonly]="readonly"
                       validationClasses="requestType"
                       appendTo="body" [clearable]="true"
                       labelForId="requestType"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       id="requestType"
                       formControlName="requestType">
              <ng-option [value]="option.lookupKey" *ngFor="let option of requestTypes">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="requestType"></app-field-error-message>
          </div>
          <div *ngIf="displayTemplateSerialField" class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired [control]="templateSerialControl"
                   for="templateSerialControl">{{lang.map.template_serial}}</label>
            <div class="input-group">
              <input id="templateSerialControl" (keyup.enter)="searchForTemplate()"
                     [formControl]="templateSerialControl" [control]="templateSerialControl"
                     validationClasses class="form-control">
              <button (click)="searchForTemplate()" class="input-group-text"><i
                class="mdi {{fileIconsEnum.SEARCH}} text-primary"></i></button>
              <app-field-error-message [control]="templateSerialControl"></app-field-error-message>
            </div>
          </div>
          <div class="col-md-4 col-sm-12 mt-5 form-check form-switch form-switch-reduce-margin-left">
            <div class="ms-3">
              <input class="form-check-input" type="checkbox" id="isConstructional"
                     formControlName="isConstructional">
              <label class="form-check-label"
                     for="isConstructional">{{lang.map.constructional}}</label>
            </div>
          </div>
        </div>
        <div *ngIf="selectedModel" class="row">
          <app-table #tableData sortableTable
                     [data]="[selectedModel]"
                     [columns]="displayedColumns">
            <table cdk-table [dataSource]="tableData.dataSource" class="table table-striped table-bordered caption-top">
              <tr *cdkNoDataRow>
                <td colspan="100" class="text-center">{{lang.map.no_records_to_display}}</td>
              </tr>
              <ng-container cdkColumnDef="fullSerial">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.serial_number}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.fullSerial}} </td>
              </ng-container>
              <ng-container cdkColumnDef="domainInfo">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.the_domain}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.domainInfo.getName()}} </td>
              </ng-container>
              <ng-container cdkColumnDef="templateStatusInfo">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.lbl_status}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.templateStatusInfo.getName()}} </td>
              </ng-container>
              <ng-container cdkColumnDef="projectTypeInfo">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.project_type}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.projectTypeInfo.getName()}} </td>
              </ng-container>
              <ng-container cdkColumnDef="createdBy">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.created_by}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.creatorInfo.getName()}} </td>
              </ng-container>
              <ng-container cdkColumnDef="createdOn">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.creation_date}}</th>
                <td cdk-cell *cdkCellDef="let row"> {{row.createdOn|date}} </td>
              </ng-container>
              <tr cdk-header-row *cdkHeaderRowDef="displayedColumns"></tr>
              <tr cdk-row *cdkRowDef="let row; columns: displayedColumns;"></tr>
            </table>
          </app-table>
        </div>
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="projectType"
                   for="projectType">{{lang.map.project_type}}</label>
            <ng-select [readonly]="readonly" validationClasses="projectType"
                       appendTo="body"
                       labelForId="projectType"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="projectType"
                       formControlName="projectType">
              <ng-option [value]="option.lookupKey"
                         *ngFor="let option of projectTypes">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message [ignoreTop]="true" controlName="projectType"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="projectName"
                   for="projectName">{{lang.map.project_name}}</label>
            <input id="projectName" validationClasses="projectName" formControlName="projectName"
                   class="form-control">
            <app-field-error-message [ignoreTop]="true" controlName="projectName"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="projectWorkArea"
                   for="projectWorkArea">{{lang.map.execution_field}}</label>
            <ng-select [readonly]="readonly"
                       validationClasses="projectWorkArea"
                       appendTo="body"
                       labelForId="projectWorkArea"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="projectWorkArea"
                       formControlName="projectWorkArea">
              <ng-option [value]="option.lookupKey"
                         *ngFor="let option of projectWorkAreas">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="projectWorkArea"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="projectDescription"
                   for="projectDescription">{{lang.map.project_description}}</label>
            <textarea name="projectDescription" validationClasses="projectDescription"
                      [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                      formControlName="projectDescription" id="projectDescription" rows="5"
                      class="form-control"></textarea>
            <app-field-error-message [ignoreTop]="true" controlName="projectDescription"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <h2 class="h6 text-primary">{{lang.map.beneficiary_country_info}}</h2>
            <hr>
          </div>
          <div class="col-sm-12 col-md-4">
            <div class="d-flex align-items-center justify-content-start gap-2">
              <div class="mb-4 ng-select-wrapper flex-grow-1 ">
                <label class="form-label" asteriskIfRequired="beneficiaryCountry"
                       for="beneficiaryCountry">{{lang.map.country}}</label>
                <ng-select [readonly]="readonly || !isOutsideQatarWorkArea" validationClasses="beneficiaryCountry"
                           (change)="loadForeignCountriesProjectsNeeds()"
                           appendTo="body"
                           labelForId="beneficiaryCountry"
                           placeholder="{{lang.map.select}}"
                           [notFoundText]="lang.map.msg_not_found"
                           [clearable]="true"
                           id="beneficiaryCountry" formControlName="beneficiaryCountry">
                  <ng-option [value]="option.id" *ngFor="let option of countriesAvailableForSelection"
                             [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
                </ng-select>
                <app-field-error-message controlName="beneficiaryCountry"></app-field-error-message>
              </div>
              <button *ngIf="!readonly && this.employeeService.checkPermissions('MANAGE_CITIES')"
                      (click)="addCountry($event)" class="btn btn-primary mt-2">{{lang.map.btn_add}}</button>
            </div>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="beneficiaryRegion"
                   for="beneficiaryRegion">{{lang.map.region}}</label>
            <input id="beneficiaryRegion" validationClasses="beneficiaryRegion" formControlName="beneficiaryRegion"
                   class="form-control">
            <app-field-error-message controlName="beneficiaryRegion"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <h2 class="h6 text-primary">{{lang.map.execution_country_info}}</h2>
            <hr>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="executionCountry"
                   for="executionCountry">{{lang.map.country}}</label>
            <ng-select [readonly]="readonly || !isOutsideQatarWorkArea" validationClasses="executionCountry"
                       appendTo="body"
                       labelForId="executionCountry"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="executionCountry"
                       formControlName="executionCountry">
              <ng-option [value]="option.id" *ngFor="let option of countriesAvailableForSelection"
                         [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="executionCountry"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="executionRegion"
                   for="executionRegion">{{lang.map.region}}</label>
            <input id="executionRegion" validationClasses="executionRegion" formControlName="executionRegion"
                   class="form-control">
            <app-field-error-message controlName="executionRegion"></app-field-error-message>
          </div>
        </div>
      </fieldset>
    </ng-container>
  </ng-template>
  <ng-template #categoryInfoTab>
    <ng-container formGroupName="categoryInfo">
      <fieldset [disabled]="readonly">
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper" *ngIf="isOutsideQatarWorkArea">
            <label class="form-label" asteriskIfRequired="domain"
                   for="domain">{{lang.map.the_domain}}</label>
            <ng-select [readonly]="readonly" (change)="onDomainChange()"
                       validationClasses="domain"
                       appendTo="body"
                       labelForId="domain"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="domain"
                       formControlName="domain">
              <ng-option [value]="option.lookupKey" *ngFor="let option of domains">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="domain"></app-field-error-message>
          </div>
          <ng-container *ngIf="domain.value === domainTypes.DEVELOPMENT" id="DACCategory">
            <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
              <label class="form-label" asteriskIfRequired="mainDACCategory"
                     for="mainDACCategory">{{lang.map.main_dac_category}}</label>
              <ng-select [readonly]="readonly" (change)="onMainDacOchaChanged()"
                         validationClasses="mainDACCategory"
                         appendTo="body"
                         labelForId="mainDACCategory"
                         placeholder="{{lang.map.select}}"
                         [notFoundText]="lang.map.msg_not_found"
                         [clearable]="true" id="mainDACCategory"
                         formControlName="mainDACCategory">
                <ng-option *ngFor="let option of mainDacCategories" [value]="option.id"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="mainDACCategory"></app-field-error-message>
            </div>
            <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
              <label class="form-label" asteriskIfRequired="subDACCategory"
                     for="subDACCategory">{{lang.map.sub_dac_category}}</label>
              <ng-select [readonly]="readonly" validationClasses="subDACCategory"
                         appendTo="body"
                         labelForId="subDACCategory"
                         placeholder="{{lang.map.select}}"
                         [notFoundText]="lang.map.msg_not_found"
                         [clearable]="true"
                         id="subDACCategory"
                         formControlName="subDACCategory">
                <ng-option *ngFor="let option of subDacCategories" [value]="option.id"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="subDACCategory"></app-field-error-message>
            </div>
          </ng-container>
          <ng-container *ngIf="domain.value === domainTypes.HUMANITARIAN" id="UNOCHACategory">
            <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
              <label class="form-label" asteriskIfRequired="mainUNOCHACategory"
                     for="mainUNOCHACategory">{{lang.map.main_unocha_category}}</label>
              <ng-select [readonly]="readonly" (change)="onMainDacOchaChanged()"
                         validationClasses="mainUNOCHACategory"
                         appendTo="body"
                         labelForId="mainUNOCHACategory"
                         placeholder="{{lang.map.select}}"
                         [notFoundText]="lang.map.msg_not_found"
                         [clearable]="true" id="mainUNOCHACategory"
                         formControlName="mainUNOCHACategory">
                <ng-option *ngFor="let option of mainOchaCategories" [value]="option.id"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="mainUNOCHACategory"></app-field-error-message>
            </div>
            <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
              <label class="form-label" asteriskIfRequired="subUNOCHACategory"
                     for="subUNOCHACategory">{{lang.map.sub_unocha_category}}</label>
              <ng-select [readonly]="readonly" validationClasses="subUNOCHACategory"
                         appendTo="body"
                         labelForId="subUNOCHACategory"
                         placeholder="{{lang.map.select}}"
                         [notFoundText]="lang.map.msg_not_found"
                         [clearable]="true"
                         id="subUNOCHACategory"
                         formControlName="subUNOCHACategory">
                <ng-option *ngFor="let option of subOchaCategories" [value]="option.id"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="subUNOCHACategory"></app-field-error-message>
            </div>
          </ng-container>
        </div>
        <div class="row" *ngIf="projectWorkArea.value && !isOutsideQatarWorkArea">
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper" *ngIf="isSoftwareProjectType()">
            <label class="form-label" asteriskIfRequired="internalProjectClassification"
                   for="internalProjectClassification">{{lang.map.internal_project_classification}}</label>
            <ng-select [readonly]="readonly"
                       validationClasses="internalProjectClassification"
                       appendTo="body" [clearable]="true"
                       labelForId="internalProjectClassification"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       id="internalProjectClassification"
                       formControlName="internalProjectClassification">
              <ng-option [value]="option.lookupKey"
                         *ngFor="let option of internalProjectClassifications">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="internalProjectClassification"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper" *ngIf="isAidsProjectType()">
            <label class="form-label" asteriskIfRequired="sanadiDomain"
                   for="sanadiDomain">{{lang.map.sanadi_classification}}</label>
            <ng-select (change)="loadSanadiMainClassification($event)" [readonly]="readonly"
                       validationClasses="sanadiDomain"
                       appendTo="body"
                       labelForId="sanadiDomain"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="sanadiDomain"
                       formControlName="sanadiDomain">
              <ng-option [value]="option.id" *ngFor="let option of sanadiDomains">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="sanadiDomain"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper" *ngIf="isAidsProjectType()">
            <label class="form-label" asteriskIfRequired="sanadiMainClassification"
                   for="sanadiMainClassification">{{lang.map.sanadi_main_classification}}</label>
            <ng-select [readonly]="readonly"
                       validationClasses="sanadiMainClassification"
                       appendTo="body"
                       labelForId="sanadiMainClassification"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="sanadiMainClassification"
                       formControlName="sanadiMainClassification">
              <ng-option [value]="option.id"
                         *ngFor="let option of sanadiMainClassifications">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="sanadiMainClassification"></app-field-error-message>
          </div>
        </div>
        <div *ngIf="displayDevGoals || (!isOutsideQatarWorkArea && projectWorkArea.value)" class="row">
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="firstSDGoal"
                   for="firstSDGoal">{{lang.map.first_sd_goal}}</label>
            <ng-select [readonly]="readonly" validationClasses="firstSDGoal"
                       appendTo="body"
                       labelForId="firstSDGoal"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="firstSDGoal"
                       formControlName="firstSDGoal">
              <ng-option *ngFor="let option of goals" [value]="option.id"
                         [disabled]="option.id === secondSDGoal.value || option.id === thirdSDGoal.value">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="firstSDGoal"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="secondSDGoal"
                   for="secondSDGoal">{{lang.map.second_sd_goal}}</label>
            <ng-select [readonly]="readonly" validationClasses="secondSDGoal"
                       appendTo="body"
                       labelForId="secondSDGoal"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="secondSDGoal"
                       formControlName="secondSDGoal">

              <ng-option *ngFor="let option of goals" [value]="option.id"
                         [disabled]="option.id === firstSDGoal.value || option.id === thirdSDGoal.value">{{option.getName()}}</ng-option>

            </ng-select>
            <app-field-error-message controlName="secondSDGoal"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 ng-select-wrapper">
            <label class="form-label" asteriskIfRequired="thirdSDGoal"
                   for="thirdSDGoal">{{lang.map.third_sd_goal}}</label>
            <ng-select [readonly]="readonly" validationClasses="thirdSDGoal"
                       appendTo="body"
                       labelForId="thirdSDGoal"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="thirdSDGoal"
                       formControlName="thirdSDGoal">

              <ng-option *ngFor="let option of goals" [value]="option.id"
                         [disabled]="option.id === firstSDGoal.value || option.id === secondSDGoal.value">{{option.getName()}}</ng-option>

            </ng-select>
            <app-field-error-message controlName="thirdSDGoal"></app-field-error-message>
          </div>
        </div>
      </fieldset>
    </ng-container>
    <fieldset *ngIf="displayDevGoals || (!isOutsideQatarWorkArea && projectWorkArea.value)" [disabled]="readonly">
      <div formGroupName="categoryGoalPercentGroup" class="position-relative mb-2">
        <div class="row" validationGroupClasses>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="firstSDGoalPercentage"
                   for="firstSDGoalPercentage">{{lang.map.first_sd_goal_percentage}}</label>
            <div class="input-group">
              <input id="firstSDGoalPercentage" validationClasses="firstSDGoalPercentage"
                     [mask]="inputMaskPatterns.PERCENT"
                     [dropSpecialCharacters]="false"
                     formControlName="firstSDGoalPercentage" class="form-control">
              <div class="input-group-append">
                <span class="input-group-text">%</span>
              </div>
              <app-field-error-message controlName="firstSDGoalPercentage"></app-field-error-message>
            </div>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="secondSDGoalPercentage"
                   for="secondSDGoalPercentage">{{lang.map.second_sd_goal_percentage}}</label>
            <div class="input-group">
              <input id="secondSDGoalPercentage" validationClasses="secondSDGoalPercentage"
                     [mask]="inputMaskPatterns.PERCENT"
                     [dropSpecialCharacters]="false"
                     formControlName="secondSDGoalPercentage" class="form-control">
              <div class="input-group-append">
                <span class="input-group-text">%</span>
              </div>
              <app-field-error-message controlName="secondSDGoalPercentage"></app-field-error-message>
            </div>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="thirdSDGoalPercentage"
                   for="thirdSDGoalPercentage">{{lang.map.third_sd_goal_percentage}}</label>
            <div class="input-group">
              <input id="thirdSDGoalPercentage" validationClasses="thirdSDGoalPercentage"
                     [mask]="inputMaskPatterns.PERCENT"
                     [dropSpecialCharacters]="false"
                     formControlName="thirdSDGoalPercentage" class="form-control">
              <div class="input-group-append">
                <span class="input-group-text">%</span>
              </div>
              <app-field-error-message controlName="thirdSDGoalPercentage"></app-field-error-message>
            </div>
          </div>
        </div>
        <group-error-message></group-error-message>
      </div>
    </fieldset>
  </ng-template>
  <ng-template #summaryInfoTab>
    <ng-container formGroupName="summaryInfo">
      <fieldset [disabled]="readonly">
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative">
            <label class="form-label" for="goals" asteriskIfRequired="goals">{{lang.map.project_goals}}</label>
            <textarea name="goals" formControlName="goals" validationClasses="goals" id="goals"
                      [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                      rows="4" class="form-control"></textarea>
            <app-field-error-message controlName="goals"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <h2 class="h6 text-primary">{{lang.map.number_of_beneficiaries}}</h2>
            <hr>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="directBeneficiaryNumber"
                   for="directBeneficiaryNumber">{{lang.map.direct_beneficiary_count}}</label>
            <input id="directBeneficiaryNumber" validationClasses="directBeneficiaryNumber"
                   onlyNumbers
                   formControlName="directBeneficiaryNumber" class="form-control">
            <app-field-error-message controlName="directBeneficiaryNumber"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="indirectBeneficiaryNumber"
                   for="indirectBeneficiaryNumber">{{lang.map.indirect_beneficiary_count}}</label>
            <input onlyNumbers id="indirectBeneficiaryNumber" validationClasses="indirectBeneficiaryNumber"
                   formControlName="indirectBeneficiaryNumber" class="form-control">
            <app-field-error-message controlName="indirectBeneficiaryNumber"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="beneficiaryFamiliesNumber"
                   for="beneficiaryFamiliesNumber">{{lang.map.beneficiary_families_count}}</label>
            <input onlyNumbers id="beneficiaryFamiliesNumber" validationClasses="beneficiaryFamiliesNumber"
                   formControlName="beneficiaryFamiliesNumber" class="form-control">
            <app-field-error-message controlName="beneficiaryFamiliesNumber"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12"><h2
            class="h6 text-primary">{{lang.map.percentage_of_direct_beneficiaries_by_age_group}}</h2>
            <hr>
          </div>
        </div>
        <div [formGroup]="form">
          <div formGroupName="summaryPercentGroup" class="position-relative mb-4">
            <div class="row" validationGroupClasses>
              <div class="col-md-3 col-sm-12 mb-4 position-relative">
                <label class="form-label" asteriskIfRequired="beneficiaries0to5"
                       for="beneficiaries0to5">{{lang.map.number_of_0_to_5}}</label>
                <input id="beneficiaries0to5" validationClasses="beneficiaries0to5" formControlName="beneficiaries0to5"
                       [mask]="inputMaskPatterns.PERCENT"
                       [dropSpecialCharacters]="false"
                       class="form-control">
                <app-field-error-message controlName="beneficiaries0to5"></app-field-error-message>
              </div>
              <div class="col-md-3 col-sm-12 mb-4 position-relative">
                <label class="form-label" asteriskIfRequired="beneficiaries5to18"
                       for="beneficiaries5to18">{{lang.map.number_of_5_to_18}}</label>
                <input id="beneficiaries5to18" validationClasses="beneficiaries5to18"
                       formControlName="beneficiaries5to18"
                       [mask]="inputMaskPatterns.PERCENT"
                       [dropSpecialCharacters]="false"
                       class="form-control">
                <app-field-error-message controlName="beneficiaries5to18"></app-field-error-message>
              </div>
              <div class="col-md-3 col-sm-12 mb-4 position-relative">
                <label class="form-label" asteriskIfRequired="beneficiaries19to60"
                       for="beneficiaries19to60">{{lang.map.number_of_19_to_60}}</label>
                <input id="beneficiaries19to60" validationClasses="beneficiaries19to60"
                       [mask]="inputMaskPatterns.PERCENT"
                       [dropSpecialCharacters]="false"
                       formControlName="beneficiaries19to60"
                       class="form-control">
                <app-field-error-message controlName="beneficiaries19to60"></app-field-error-message>
              </div>
              <div class="col-md-3 col-sm-12 mb-4 position-relative">
                <label class="form-label" asteriskIfRequired="beneficiariesOver60"
                       for="beneficiariesOver60">{{lang.map.number_of_above_60}}</label>
                <input id="beneficiariesOver60" validationClasses="beneficiariesOver60"
                       [mask]="inputMaskPatterns.PERCENT"
                       [dropSpecialCharacters]="false"
                       formControlName="beneficiariesOver60"
                       class="form-control">
                <app-field-error-message controlName="beneficiariesOver60"></app-field-error-message>
              </div>
            </div>
            <group-error-message></group-error-message>
          </div>
        </div>
        <ng-container *ngIf="isCharityProfile || isInstitutionProfile">
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" asteriskIfRequired="needsAssessment"
                     for="needsAssessment">{{lang.map.project_needs_assessment}}</label>
              <textarea name="needsAssessment" formControlName="needsAssessment"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        validationClasses="needsAssessment" id="needsAssessment" rows="4"
                        class="form-control"></textarea>
              <app-field-error-message controlName="needsAssessment"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" for="successItems"
                     asteriskIfRequired="successItems">{{lang.map.project_success_items}}</label>
              <textarea name="successItems" id="successItems" validationClasses="successItems"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        formControlName="successItems" rows="4"
                        class="form-control"></textarea>
              <app-field-error-message controlName="successItems"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" for="outputs" asteriskIfRequired="outputs">{{lang.map.project_outputs}}</label>
              <textarea name="outputs" id="outputs" formControlName="outputs" validationClasses="outputs"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        rows="4" class="form-control"></textarea>
              <app-field-error-message controlName="outputs"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" for="expectedResults"
                     asteriskIfRequired="expectedResults">{{lang.map.project_expected_results}}</label>
              <textarea name="expectedResults" id="expectedResults" validationClasses="expectedResults"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        formControlName="expectedResults" rows="4" class="form-control"></textarea>
              <app-field-error-message controlName="expectedResults"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" for="expectedImpact"
                     asteriskIfRequired="expectedImpact">{{lang.map.project_expected_impacts}}</label>
              <textarea name="expectedImpact" id="expectedImpact" validationClasses="expectedImpact"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        formControlName="expectedImpact" rows="4" class="form-control"></textarea>
              <app-field-error-message controlName="expectedImpact"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 mb-4 position-relative">
              <label class="form-label" for="sustainabilityItems"
                     asteriskIfRequired="sustainabilityItems">{{lang.map.project_sustainability_items}}</label>
              <textarea name="sustainabilityItems" formControlName="sustainabilityItems"
                        [maxlength]="customValidators.defaultLengths.EXPLANATIONS"
                        validationClasses="sustainabilityItems" id="sustainabilityItems" rows="4"
                        class="form-control"></textarea>
              <app-field-error-message controlName="sustainabilityItems"></app-field-error-message>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4 mb-4 position-relative">
              <label class="form-label" for="exitMechanism"
                     asteriskIfRequired="exitMechanism">{{lang.map.exit_mechanism}}</label>
              <ng-select [readonly]="readonly" validationClasses="exitMechanism"
                         appendTo="body"
                         labelForId="exitMechanism"
                         placeholder="{{lang.map.select}}"
                         [notFoundText]="lang.map.msg_not_found"
                         [clearable]="true"
                         id="exitMechanism"
                         formControlName="exitMechanism">
                <ng-option *ngFor="let option of exitMechanisms" [value]="option.id"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="exitMechanism"></app-field-error-message>
            </div>
          </div>
        </ng-container>
      </fieldset>
    </ng-container>
  </ng-template>
  <ng-template #componentsBudgetsTab>
    <fieldset [disabled]="readonly">
      <div class="row">
        <div class="d-flex align-items-center justify-content-start">
          <h2 class="h6 text-primary">{{lang.map.project_components}}</h2>
          <button (click)="onClickAddProjectComponent()" class="btn text-primary icon-btn"><i
            class="mdi mdi-plus-box"></i></button>
        </div>
      </div>
      <ng-container formGroupName="componentBudgetInfo">
        <ng-container formArrayName="componentList">
          <div [formGroupName]="i" *ngFor="let control of componentBudgetArray.controls; index as i" class="row">
            <div class="col-md-4 col-sm-12 mb-4 position-relative">
              <label class="form-label" asteriskIfRequired="componentName"
                     for="componentName">{{lang.map.component_name}}</label>
              <input id="componentName" validationClasses="componentName" formControlName="componentName"
                     class="form-control" maxlength="100">
              <app-field-error-message controlName="componentName"></app-field-error-message>
            </div>
            <div class="col-md-4 col-sm-12 mb-4 position-relative">
              <label class="form-label" asteriskIfRequired="details"
                     for="details">{{lang.map.details}}</label>
              <input id="details" validationClasses="details" formControlName="details"
                     class="form-control" maxlength="250">
              <app-field-error-message controlName="details"></app-field-error-message>
            </div>
            <div class="col-md-4 col-sm-12 mb-4 position-relative">
              <label class="form-label" asteriskIfRequired="totalCost"
                     for="totalCost">{{lang.map.total_cost}}</label>
              <input id="totalCost" validationClasses="totalCost" formControlName="totalCost"
                     class="form-control" maxlength="20">
              <app-field-error-message controlName="totalCost"></app-field-error-message>
            </div>
          </div>
        </ng-container>
      </ng-container>
      <div *ngIf="currentProjectComponent" class="d-flex align-items-center justify-content-center">
        <button (click)="saveProjectComponent()" [disabled]="currentProjectComponent?.invalid || readonly"
                class="btn btn-primary m-2">{{ lang.map.btn_save}}</button>
        <button (click)="cancelProjectComponent()"
                class="btn btn-secondary m-2">{{lang.map.btn_cancel}}</button>
      </div>
      <table *ngIf="model" class="table mt-3 table-striped table-bordered caption-top"
             cdk-table [dataSource]="(model?.componentList)!">
        <ng-container cdkColumnDef="componentName">
          <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.component_name}}</th>
          <td cdk-cell *cdkCellDef="let row"> {{row.componentName}} </td>
        </ng-container>
        <ng-container cdkColumnDef="details">
          <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.details}}</th>
          <td cdk-cell *cdkCellDef="let row"> {{row.details}} </td>
        </ng-container>
        <ng-container cdkColumnDef="totalCost">
          <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.total_cost}}</th>
          <td cdk-cell *cdkCellDef="let row" class="text-end"> {{row.totalCost}} </td>
        </ng-container>
        <ng-container cdkColumnDef="totalComponentCostLabel">
          <td cdk-footer-cell colspan="2" class="text-end" *cdkFooterCellDef="let row">
            <span><b> {{lang.map.total_cost}}: </b></span>
          </td>
        </ng-container>
        <ng-container cdkColumnDef="totalComponentCost">
          <td cdk-footer-cell class="text-end" *cdkFooterCellDef="let row">
            <span><b>{{projectTotalCostField ? projectTotalCostField.value : 0}}</b></span>
          </td>
        </ng-container>
        <ng-container cdkColumnDef="actions">
          <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.lbl_actions}}</th>
          <td cdk-cell *cdkCellDef="let row; let i = index;" class="table-actions">
            <div class="d-flex flex-row">
              <button (click)="onClickDeleteProjectComponent(row)" class="btn btn-link outline-none"
                      [disabled]="readonly"
                      tooltip="{{lang.map.btn_delete}}">
                <i class="mdi mdi-close-box"></i>
              </button>
              <button (click)="onClickEditProjectComponent(row)" class="btn btn-link outline-none"
                      [disabled]="readonly"
                      tooltip="{{lang.map.btn_edit}}">
                <i class="mdi mdi-pen"></i>
              </button>
            </div>
          </td>
        </ng-container>
        <tr cdk-header-row *cdkHeaderRowDef="projectListColumns"></tr>
        <tr cdk-row *cdkRowDef="let row; columns: projectListColumns;"></tr>
        <tr cdk-footer-row *cdkFooterRowDef="projectListTotalCostFooterColumns"
            [hidden]="model && model.componentList && model.componentList.length === 0"></tr>
        <tr *cdkNoDataRow>
          <td colspan="100" class="text-center">{{lang.map.no_records_to_display}}</td>
        </tr>
      </table>
    </fieldset>
  </ng-template>
  <ng-template #evaluationIndicatorsTab>
    <fieldset [disabled]="readonly">
      <div class="row">
        <div class="d-flex align-items-center justify-content-start">
          <h2 class="h6 text-primary">{{lang.map.project_evaluation_indicators}}</h2>
          <button (click)="openAddIndicatorForm()" class="btn text-primary icon-btn"><i
            class="mdi mdi-plus-box"></i></button>
        </div>
      </div>
      <ng-container [formGroup]="evaluationIndicatorForm" *ngIf="addIndicatorFormActive">
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" for="indicator"
                   asteriskIfRequired="indicator">{{lang.map.indicator}}</label>
            <ng-select [readonly]="readonly" validationClasses="indicator"
                       appendTo="body"
                       labelForId="indicator"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="indicator"
                       formControlName="indicator">
              <ng-option *ngFor="let option of indicators" [value]="option.id"
                         [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="indicator"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="percentage"
                   for="percentage">{{lang.map.percentage}}</label>
            <input id="percentage" validationClasses="percentage" formControlName="percentage"
                   class="form-control" maxlength="5" max="100">
            <app-field-error-message controlName="percentage"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="notes"
                   for="notes">{{lang.map.notes}}</label>
            <input id="notes" validationClasses="notes" formControlName="notes"
                   class="form-control" maxlength="250">
            <app-field-error-message controlName="notes"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-12 text-center action-container mb-3">
            <button [disabled]="!evaluationIndicatorForm.valid" (click)="saveIndicator()"
                    class="btn btn-primary">{{lang.map.btn_save}}</button>
            <button class="btn btn-secondary"
                    (click)="cancelAddIndicator()">{{lang.map.btn_cancel}}</button>
          </div>
        </div>
      </ng-container>
      <div class="row">
        <div class="col-12">
          <app-table #table [columns]="indicatorsDisplayedColumns"
                     [data]="evaluationIndicators" [selectable]="true"
                     [useSearchToFilter]="true"
                     sortableTable>
            <table [dataSource]="table.dataSource" cdk-table
                   class="table table-striped table-bordered caption-top">
              <ng-container cdkColumnDef="index">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> #
                </th>
                <td *cdkCellDef="let row; let i = index;" cdk-cell> {{i + 1}} </td>
              </ng-container>
              <ng-container cdkColumnDef="indicator">
                <th *cdkHeaderCellDef cdk-header-cell sortable-header> {{lang.map.indicator}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.indicatorInfo?.getName() || ''}} </td>
              </ng-container>
              <ng-container cdkColumnDef="percentage">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> {{lang.map.percentage}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.percentage}} </td>
              </ng-container>
              <ng-container cdkColumnDef="notes">
                <th *cdkHeaderCellDef cdk-header-cell sortable-header> {{lang.map.notes}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.notes}} </td>
              </ng-container>
              <ng-container cdkColumnDef="actions">
                <th *cdkHeaderCellDef cdk-header-cell> {{lang.map.lbl_actions}}</th>
                <td *cdkCellDef="let row" cdk-cell class="table-actions">
                  <div class="d-flex flex-row">
                    <button (click)="removeIndicator($event, row)"
                            [disabled]="(readonly || addIndicatorFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_remove}}">
                      <i class="mdi mdi-close-box"></i>
                    </button>
                    <button (click)="selectIndicator($event, row)"
                            [disabled]="(readonly || addIndicatorFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_edit}}">
                      <i class="mdi mdi-pen"></i>
                    </button>
                  </div>
                </td>
              </ng-container>
              <tr *cdkHeaderRowDef="indicatorsDisplayedColumns" cdk-header-row></tr>
              <tr *cdkRowDef="let row; columns: indicatorsDisplayedColumns;" cdk-row></tr>
              <!--suppress HtmlUnknownBooleanAttribute -->
              <tr *cdkNoDataRow>
                <td class="text-center" colspan="100">{{lang.map.no_records_to_display}}</td>
              </tr>
            </table>
          </app-table>
        </div>
      </div>
    </fieldset>
  </ng-template>
  <ng-template #projectAddressesTab>
    <fieldset [disabled]="readonly">
      <div class="row">
        <div class="d-flex align-items-center justify-content-start">
          <h2 class="h6 text-primary">{{lang.map.project_addresses}}</h2>
          <button (click)="openAddProjectAddressForm()" class="btn text-primary icon-btn"><i
            class="mdi mdi-plus-box"></i></button>
        </div>
      </div>
      <ng-container [formGroup]="projectAddressForm" *ngIf="addProjectAddressFormActive">
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="beneficiaryRegion"
                   for="addressBeneficiaryRegion">{{lang.map.region}}</label>
            <input id="addressBeneficiaryRegion" validationClasses="beneficiaryRegion"
                   formControlName="beneficiaryRegion"
                   class="form-control">
            <app-field-error-message controlName="beneficiaryRegion"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="address"
                   for="projectAddress">{{lang.map.address_details}}</label>
            <input id="projectAddress" validationClasses="address" formControlName="address"
                   class="form-control" maxlength="250">
            <app-field-error-message controlName="address"></app-field-error-message>
          </div>
          <div class="col-sm-4 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="latitude"
                   for="latitude">{{lang.map.latitude}} / {{lang.map.longitude}}</label>
            <div class="input-group">
              <input id="latitude" validationClasses="latitude" formControlName="latitude" class="form-control">
              <button type="button" (click)="openMapMarker()" class="input-group-text">
                <i class="mdi mdi-map-marker text-primary"></i>
              </button>
              <input id="longitude" validationClasses="longitude" formControlName="longitude" class="form-control">
            </div>
            <app-field-error-message controlName="latitude"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-12 text-center action-container mb-3">
            <button [disabled]="isDisabledSaveAddress()" (click)="saveProjectAddress()"
                    class="btn btn-primary">{{lang.map.btn_save}}</button>
            <button class="btn btn-secondary"
                    (click)="cancelAddProjectAddress()">{{lang.map.btn_cancel}}</button>
          </div>
        </div>
      </ng-container>
      <div class="row">
        <div class="col-12">
          <app-table #table [columns]="projectAddressesDisplayedColumns"
                     [data]="projectAddresses" [selectable]="true"
                     [useSearchToFilter]="true"
                     sortableTable>
            <table [dataSource]="table.dataSource" cdk-table
                   class="table table-striped table-bordered caption-top">
              <ng-container cdkColumnDef="index">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> #
                </th>
                <td *cdkCellDef="let row; let i = index;" cdk-cell> {{i + 1}} </td>
              </ng-container>
              <ng-container cdkColumnDef="beneficiaryRegion">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> {{lang.map.region}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.beneficiaryRegion}} </td>
              </ng-container>
              <ng-container cdkColumnDef="address">
                <th *cdkHeaderCellDef cdk-header-cell sortable-header> {{lang.map.address_details}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.address}} </td>
              </ng-container>
              <ng-container cdkColumnDef="location">
                <th cdk-header-cell *cdkHeaderCellDef> {{lang.map.item_location}}</th>
                <td cdk-cell *cdkCellDef="let row">
                  <button (click)="openLocationMap(row)" [tooltip]="lang.map.show_location_on_map" class="btn icon-btn">
                    <i
                      class="mdi mdi-map-marker text-primary"></i>
                  </button>
                </td>
              </ng-container>
              <ng-container cdkColumnDef="actions">
                <th *cdkHeaderCellDef cdk-header-cell> {{lang.map.lbl_actions}}</th>
                <td *cdkCellDef="let row" cdk-cell class="table-actions">
                  <div class="d-flex flex-row">
                    <button (click)="removeProjectAddress($event, row)"
                            [disabled]="(readonly || addProjectAddressFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_remove}}">
                      <i class="mdi mdi-close-box"></i>
                    </button>
                    <button (click)="selectProjectAddress($event, row)"
                            [disabled]="(readonly || addProjectAddressFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_edit}}">
                      <i class="mdi mdi-pen"></i>
                    </button>
                  </div>
                </td>
              </ng-container>
              <tr *cdkHeaderRowDef="projectAddressesDisplayedColumns" cdk-header-row></tr>
              <tr *cdkRowDef="let row; columns: projectAddressesDisplayedColumns;" cdk-row></tr>
              <!--suppress HtmlUnknownBooleanAttribute -->
              <tr *cdkNoDataRow>
                <td class="text-center" colspan="100">{{lang.map.no_records_to_display}}</td>
              </tr>
            </table>
          </app-table>
        </div>
      </div>
    </fieldset>
  </ng-template>
  <ng-template #foreignCountriesProjectsTab>
    <fieldset [disabled]="readonly">
      <div class="row">
        <div class="d-flex align-items-center justify-content-start">
          <h2 class="h6 text-primary">{{lang.map.project_model_foreign_countries_projects}}</h2>
          <button (click)="openAddPMForeignCountriesProjectForm()" class="btn text-primary icon-btn"><i
            class="mdi mdi-plus-box"></i></button>
        </div>
      </div>
      <ng-container [formGroup]="pMForeignCountriesProjectForm" *ngIf="addPMForeignCountriesProjectFormActive">
        <div class="row">
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" for="objectDBId"
                   asteriskIfRequired="objectDBId">{{lang.map.project_needs}}</label>
            <ng-select [readonly]="readonly" validationClasses="objectDBId"
                       appendTo="body"
                       labelForId="objectDBId"
                       placeholder="{{lang.map.select}}"
                       [notFoundText]="lang.map.msg_not_found"
                       [clearable]="true"
                       id="objectDBId"
                       formControlName="objectDBId">
              <ng-option *ngFor="let option of foreignCountriesProjectsNeeds"
                         [value]="option.id">{{option.projectName}}</ng-option>
            </ng-select>
            <app-field-error-message controlName="objectDBId"></app-field-error-message>
          </div>
          <div class="col-md-4 col-sm-12 mb-4 position-relative">
            <label class="form-label" asteriskIfRequired="notes"
                   for="needsNotes">{{lang.map.notes}}</label>
            <input id="needsNotes" validationClasses="notes" formControlName="notes"
                   class="form-control" maxlength="250">
            <app-field-error-message controlName="notes"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-12 text-center action-container mb-3">
            <button [disabled]="!pMForeignCountriesProjectForm.valid" (click)="savePMForeignCountriesProject()"
                    class="btn btn-primary">{{lang.map.btn_save}}</button>
            <button class="btn btn-secondary"
                    (click)="cancelAddPMForeignCountriesProject()">{{lang.map.btn_cancel}}</button>
          </div>
        </div>
      </ng-container>
      <div class="row">
        <div class="col-12">
          <app-table #table [columns]="pMForeignCountriesProjectsDisplayedColumns"
                     [data]="pMForeignCountriesProjects" [selectable]="true"
                     [useSearchToFilter]="true"
                     sortableTable>
            <table [dataSource]="table.dataSource" cdk-table
                   class="table table-striped table-bordered caption-top">
              <ng-container cdkColumnDef="index">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> #
                </th>
                <td *cdkCellDef="let row; let i = index;" cdk-cell> {{i + 1}} </td>
              </ng-container>
              <ng-container cdkColumnDef="projectName">
                <th *cdkHeaderCellDef cdk-header-cell
                    sortable-header> {{lang.map.project_name}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.projectName}} </td>
              </ng-container>
              <ng-container cdkColumnDef="notes">
                <th *cdkHeaderCellDef cdk-header-cell sortable-header> {{lang.map.notes}}</th>
                <td *cdkCellDef="let row" cdk-cell> {{row.notes}} </td>
              </ng-container>
              <ng-container cdkColumnDef="actions">
                <th *cdkHeaderCellDef cdk-header-cell> {{lang.map.lbl_actions}}</th>
                <td *cdkCellDef="let row" cdk-cell class="table-actions">
                  <div class="d-flex flex-row">
                    <button (click)="removePMForeignCountriesProject($event, row)"
                            [disabled]="(readonly || addPMForeignCountriesProjectFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_remove}}">
                      <i class="mdi mdi-close-box"></i>
                    </button>
                    <button (click)="selectPMForeignCountriesProject($event, row)"
                            [disabled]="(readonly || addPMForeignCountriesProjectFormActive)"
                            class="btn btn-link outline-none" tooltip="{{lang.map.btn_edit}}">
                      <i class="mdi mdi-pen"></i>
                    </button>
                  </div>
                </td>
              </ng-container>
              <tr *cdkHeaderRowDef="pMForeignCountriesProjectsDisplayedColumns" cdk-header-row></tr>
              <tr *cdkRowDef="let row; columns: pMForeignCountriesProjectsDisplayedColumns;" cdk-row></tr>
              <!--suppress HtmlUnknownBooleanAttribute -->
              <tr *cdkNoDataRow>
                <td class="text-center" colspan="100">{{lang.map.no_records_to_display}}</td>
              </tr>
            </table>
          </app-table>
        </div>
      </div>
    </fieldset>
  </ng-template>
  <ng-template #specialExplanationTab>
    <fieldset [disabled]="readonly">
      <div class="row">
        <div class="col-sm-12 mb-4 position-relative">
          <label class="form-label" asteriskIfRequired="description"
                 for="description">{{lang.map.special_explanations}}</label>
          <textarea name="description" formControlName="description" validationClasses="description"
                    id="description" rows="4" class="form-control"></textarea>
          <app-field-error-message controlName="description"></app-field-error-message>
        </div>
      </div>
    </fieldset>
  </ng-template>
  <ng-template #commentsTabTemplate>
    <div class="d-flex flex-row align-items-center justify-content-start">
      <button [disabled]="!isAddCommentAllowed()" (click)="commentsCtrl.openCommentDialog()"
              class="d-inline-block btn p-0 icon-btn"><i
        class="mdi mdi-plus-box text-primary"></i></button>
    </div>
    <app-comments #commentsCtrl [caseId]="model?.id" [service]="service.commentService"
                  [readonly]="readonly"></app-comments>
  </ng-template>
  <ng-template #attachmentsTab>
    <attachments [disabled]="isAttachmentReadonly()" [caseId]="model?.id" [caseType]="model?.caseType"
                 [service]="service.documentService" [model]="model" [formProperties]="formProperties"></attachments>
  </ng-template>
</ng-container>
