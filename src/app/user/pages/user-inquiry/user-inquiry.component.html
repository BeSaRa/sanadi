<div class="container bg-white shadow-sm p-4 h-100">
  <fieldset class="mb-3">
    <legend><span class="h6 text-primary">{{langService.map.menu_inquiries}}</span></legend>
    <form [formGroup]="form" autocomplete="off" action="#">
      <!--  Inquiry Types  -->
      <div class="row">
        <div class="col mb-3">
          <div class="form-check form-check-inline">
            <input formControlName="inquiryType" [value]="false" class="form-check-input" type="radio"
                   name="inquiryType"
                   id="inquiryByName">
            <label class="form-check-label" for="inquiryByName">
              {{langService.map.inquiry_by_name}}
            </label>
          </div>
          <div class="form-check form-check-inline">
            <input formControlName="inquiryType" [value]="true" class="form-check-input" type="radio" name="inquiryType"
                   id="inquiryById">
            <label class="form-check-label" for="inquiryById">
              {{langService.map.inquiry_by_id}}
            </label>
          </div>
        </div>
      </div>
      <!-- Search By Name -->
      <div formGroupName="searchByName" *ngIf="!displayIdCriteria" class="row">
        <div class="col flex-grow-1">
          <div class="mb-3">
            <label for="searchMethod">Search Method</label>
            <select formControlName="operator" class="form-select" id="searchMethod" name="idType">
              <option [value]="option.lookupKey" *ngFor="let option of stringOperators">{{option.getName()}}</option>
            </select>
          </div>
        </div>
        <div class="col flex-grow-1">
          <div class="mb-3">
            <label for="arName">{{langService.map.arabic_name}}</label>
            <input type="text" formControlName="arName" id="arName" class="form-control">
          </div>
        </div>
        <div class="col flex-grow-1">
          <div class="mb-3">
            <label for="enName">{{langService.map.english_name}}</label>
            <input type="text" formControlName="enName" id="enName" class="form-control" name="enName">
          </div>
        </div>
      </div>
      <!-- Search By Id  -->
      <div formGroupName="searchById" *ngIf="displayIdCriteria" class="row flex-sm-column flex-md-row">
        <div class="col flex-grow-1">
          <div class="mb-3">
            <label for="idType">{{langService.map.id_type}}</label>
            <select formControlName="benPrimaryIdType" class="form-select" id="idType" name="idType">
              <option [ngValue]="option.lookupKey" *ngFor="let option of idTypes">{{option.getName()}}</option>
            </select>
          </div>
        </div>
        <div class="col flex-grow-1">
          <div class="mb-3">
            <label for="text">{{langService.map.id_number}}</label>
            <input type="text" formControlName="benPrimaryIdNumber" id="text" class="form-control"
                   name="benPrimaryIdNumber">
          </div>
        </div>
        <div *ngIf="displayNationality" class="col flex-grow-1">
          <div class="mb-3">
            <label for="nationality">{{langService.map.lbl_nationality}}</label>
            <select formControlName="benPrimaryIdNationality" id="nationality" class="form-select">
              <option *ngFor="let option of nationalities">{{option.getName()}}</option>
            </select>
          </div>
        </div>
      </div>
      <!-- Form Button -->
      <div class="row">
        <div class="col d-flex flex-row justify-content-start">
          <button (click)="search()" [disabled]="currentForm?.invalid" class="btn shadow-sm btn-primary">Search</button>
          <button (click)="resetCurrentForm()" class="btn shadow-sm btn-secondary mx-3">Clear</button>
        </div>
      </div>
    </form>
  </fieldset>
  <div *ngIf="!!beneficiary" class="row">
    <div class="col-12">
      <div><h1 class="h6 text-primary">{{langService.map.personal_info}}</h1></div>
      <div class="table-responsive column-style">
        <table class="table table-bordered caption-top">
          <tbody>
          <tr>
            <th>{{langService.map.arabic_name}}</th>
            <td>{{beneficiary?.arName}}</td>
            <th>{{langService.map.english_name}}</th>
            <td>{{beneficiary?.enName}}</td>
          </tr>
          <tr>
            <th>{{langService.map.lbl_nationality}}</th>
            <td>{{beneficiary?.benPrimaryIdNationalityInfo?.getName()}}</td>
            <th>{{langService.map.gender}}</th>
            <td>{{beneficiary?.genderInfo?.getName()}}</td>
          </tr>
          <tr>
            <th>{{langService.map.date_of_birth}}</th>
            <td>{{beneficiary?.dateOfBirth|date}}</td>
            <th>{{langService.map.sponsors_count}}</th>
            <td class="position-relative">
              <div class="d-flex align-items-center flex-row h-100 w-100">
                <span>{{beneficiary?.benDependentsCount}}</span><span class="flex-grow-1"></span>
                <button disabled class="btn btn-sm btn-primary shadow-sm">Show Details</button>
              </div>
            </td>
          </tr>
          </tbody>
        </table><!-- table -->
      </div><!-- table container-->
    </div>
  </div><!-- -->
  <!--  we hide this part cause there is no integration with MOI yet -->
  <div *ngIf="false" class="row">
    <div class="col-12">
      <div><h6>{{langService.map.family_info}}</h6></div>
      <div class="table-responsive">
        <table class="table table-striped table-bordered caption-top">
          <thead>
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Relation</th>
            <th scope="col">ID Number</th>
            <th scope="col">ID type</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>Ahmed Mohamed Mostafa Ismail</td>
            <td>Son</td>
            <td>30697114</td>
            <td>Passport</td>
          </tr>
          <tr>
            <td>Ahmed Mohamed Mostafa Ismail</td>
            <td>Son</td>
            <td>30697114</td>
            <td>Passport</td>
          </tr>
          <tr>
            <td>Ahmed Mohamed Mostafa Ismail</td>
            <td>Son</td>
            <td>30697114</td>
            <td>Passport</td>
          </tr>
          <tr>
            <td>Ahmed Mohamed Mostafa Ismail</td>
            <td>Son</td>
            <td>30697114</td>
            <td>Passport</td>
          </tr>
          </tbody>
        </table><!-- table -->
      </div><!-- table container-->
    </div>
  </div>
  <div *ngIf="requests.length" class="row">
    <div class="col">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="nav-link active" id="personal-aid-tab" data-bs-toggle="tab" href="#personal-aid" role="tab"
             aria-controls="personal-aids" aria-selected="true">{{langService.map.personal_aid}}</a>
        </li>
        <!--  we hide this part cause there is no integration with MOI yet  -->
        <!--        <li class="nav-item" role="presentation">-->
        <!--          <a class="nav-link" id="family-aids-tab" data-bs-toggle="tab" href="#family-aids" role="tab"-->
        <!--             aria-controls="family-aids"-->
        <!--             aria-selected="false">Family Aids</a>-->
        <!--        </li>-->
      </ul>
      <div class="tab-content py-3">
        <div class="tab-pane fade show active" id="personal-aid" role="tabpanel" aria-labelledby="personal-aid-tab">
          <div class="row">
            <div class="col-12 d-flex align-items-center justify-content-end">
              <button class="btn btn-link outline-none"
                      tooltip="{{langService.map.print}}"
                      (click)="printResult($event)">
                <i class="mdi mdi-printer"></i></button>
            </div>
          </div>
          <table class="table table-striped table-bordered caption-top">
            <thead role="rowgroup">
            <tr>
              <th>{{langService.map.request_number}}</th>
              <th>{{langService.map.request_date}}</th>
              <th>{{langService.map.lbl_org_unit}}</th>
              <th>{{langService.map.aid_status}}</th>
              <th>{{langService.map.request_aid_amount}}</th>
              <th>{{langService.map.aid_type}}</th>
              <th>{{langService.map.approved_aid_amount}}</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let request of requests;">
              <div *ngIf="request.aids && request.aids.length > 0; then multiAidRow else noAidRow"></div>
              <ng-template #multiAidRow>
                <tr *ngFor="let aid of request.aids; let firstAid = first;">
                  <td *ngIf="firstAid" [rowSpan]="request.aids.length"><span
                    class="dir-ltr d-inline-block"> {{request.requestFullSerial}} </span></td>
                  <td *ngIf="firstAid" [rowSpan]="request.aids.length"> {{request.creationDate|date}} </td>
                  <td *ngIf="firstAid" [rowSpan]="request.aids.length"> {{request.orgBranchInfo.getName()}} </td>
                  <td *ngIf="firstAid" [rowSpan]="request.aids.length"> {{request.statusInfo.getName()}} </td>
                  <td *ngIf="firstAid" [rowSpan]="request.aids.length"> {{request.requestedAidAmount}} </td>
                  <td> {{aid.aidLookupInfo.getName()}} </td>
                  <td> {{aid.aidAmount}} </td>
                </tr>
              </ng-template>
              <ng-template #noAidRow>
                <tr>
                  <td><span class="dir-ltr d-inline-block"> {{request.requestFullSerial}} </span></td>
                  <td> {{request.creationDate|date}} </td>
                  <td> {{request.orgBranchInfo.getName()}} </td>
                  <td> {{request.statusInfo.getName()}} </td>
                  <td> {{request.requestedAidAmount}} </td>
                  <td></td>
                  <td></td>
                </tr>
              </ng-template>
            </ng-container>
            </tbody>
          </table>
          <!--<table class="table table-striped table-bordered caption-top" cdk-table [dataSource]="requests">
            <ng-container cdkColumnDef="requestNumber">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.request_number}}</th>
              <td cdk-cell *cdkCellDef="let row"><span class="dir-ltr d-inline-block"> {{row.requestFullSerial}} </span>
              </td>
            </ng-container>
            <ng-container cdkColumnDef="requestDate">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.request_date}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.creationDate|date}} </td>
            </ng-container>
            <ng-container cdkColumnDef="organization">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.lbl_org_unit}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.orgBranchInfo.getName()}} </td>
            </ng-container>
            <ng-container cdkColumnDef="aidType">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.aid_type}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.aidType}} </td>
            </ng-container>
            <ng-container cdkColumnDef="requestedAidAmount">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.request_aid_amount}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.requestedAidAmount}} </td>
            </ng-container>
            <ng-container cdkColumnDef="aidStatus">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.aid_status}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.statusInfo.getName()}} </td>
            </ng-container>
            <ng-container cdkColumnDef="approvedValue">
              <th cdk-header-cell *cdkHeaderCellDef> {{langService.map.approved_aid_amount}}</th>
              <td cdk-cell *cdkCellDef="let row"> {{row.aidAmount}} </td>
            </ng-container>
            <tr cdk-header-row *cdkHeaderRowDef="personalRequestColumns"></tr>
            <tr cdk-row *cdkRowDef="let row; columns: personalRequestColumns;"></tr>
          </table>-->
        </div>
        <!--        <div class="tab-pane fade show" id="family-aids" role="tabpanel" aria-labelledby="personal-aids">-->
        <!--          <div class="table-responsive">-->
        <!--            <table class="table table-striped table-bordered caption-top">-->
        <!--              <thead>-->
        <!--              <tr>-->
        <!--                <th scope="col">Request Number</th>-->
        <!--                <th scope="col">Request Date</th>-->
        <!--                <th scope="col">Foundation / Charity</th>-->
        <!--                <th scope="col">Type of Aid</th>-->
        <!--                <th scope="col">Request Status</th>-->
        <!--                <th scope="col">Aid Value</th>-->
        <!--                <th scope="col">Approved Value</th>-->
        <!--              </tr>-->
        <!--              </thead>-->
        <!--              <tbody>-->
        <!--              <tr>-->
        <!--                <td><span class="dir-ltr d-inline-block">2020-AID-1265</span></td>-->
        <!--                <td>20-12-2021</td>-->
        <!--                <td>Qatar Charity</td>-->
        <!--                <td>Medical Aid</td>-->
        <!--                <td>Approved</td>-->
        <!--                <td>150,000 QR</td>-->
        <!--                <td>100,000 QR</td>-->
        <!--              </tr>-->
        <!--              <tr>-->
        <!--                <td><span class="dir-ltr d-inline-block">2020-AID-1265</span></td>-->
        <!--                <td>20-12-2021</td>-->
        <!--                <td>Eid Charity</td>-->
        <!--                <td>Medical Aid</td>-->
        <!--                <td>Approved</td>-->
        <!--                <td>150,000 QR</td>-->
        <!--                <td>100,000 QR</td>-->
        <!--              </tr>-->
        <!--              <tr>-->
        <!--                <td><span class="dir-ltr d-inline-block">2020-AID-1265</span></td>-->
        <!--                <td>20-12-2021</td>-->
        <!--                <td>Qatar Foundation</td>-->
        <!--                <td>Medical Aid</td>-->
        <!--                <td>Approved</td>-->
        <!--                <td>150,000 QR</td>-->
        <!--                <td>100,000 QR</td>-->
        <!--              </tr>-->
        <!--              <tr>-->
        <!--                <td><span class="dir-ltr d-inline-block">2020-AID-1265</span></td>-->
        <!--                <td>20-12-2021</td>-->
        <!--                <td>Qatar Foundation</td>-->
        <!--                <td>Medical Aid</td>-->
        <!--                <td>Approved</td>-->
        <!--                <td>150,000 QR</td>-->
        <!--                <td>100,000 QR</td>-->
        <!--              </tr>-->
        <!--              </tbody>-->
        <!--            </table>&lt;!&ndash; table &ndash;&gt;-->
        <!--          </div>&lt;!&ndash; table container&ndash;&gt;-->
        <!--        </div>-->
      </div>
    </div>
  </div>
</div>
