<div class="row">
  <app-page-header [clickOnReload$]="reload$" pageTitle="menu_under_process"></app-page-header>
  <app-grid-search (searchTextEvent)="search($event)"></app-grid-search>
</div>
<div class="mt-3">
  <div class="table-responsive">
    <table class="table table-striped table-bordered caption-top">
      <thead role="rowgroup">
      <tr>
        <th>{{langService.map.request_number}}</th>
        <th class="date-column">{{langService.map.request_date}}</th>
        <th>{{langService.map.lbl_organization}}</th>
        <th>{{langService.map.request_status}}</th>
        <th>{{langService.map.request_aid_amount}}</th>
        <th>{{langService.map.lbl_actions}} </th>
      </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let request of requests;">
        <tr>
          <td><span class="dir-ltr d-inline-block"> {{request.requestFullSerial}} </span></td>
          <td class="date-column"> {{request.creationDateString}} </td>
          <td>{{request.orgInfo.getName()}} - {{request.orgBranchInfo.getName()}} </td>
          <td> {{request.requestStatusInfo.getName()}} </td>
          <td> {{request.requestedAidAmount | mask:inputMaskPatterns.SEPARATOR:inputMaskPatterns.THOUSAND_SEPARATOR}} </td>
          <td class="table-actions">
            <div class="d-flex flex-row">
              <a href="#" (click)="printRequest($event, request)" tooltip="{{langService.map.print_request_form}}"
                 class="icon-btn">
                <i class="mdi mdi-printer"></i>
              </a>
              <a href="#" (click)="request.showLog($event)" tooltip="{{langService.map.show_logs}}"
                 class="icon-btn">
                <i class="mdi mdi-history"></i>
              </a>
              <button *ngIf="empService.checkPermissions('EDIT_SUBVENTION_REQUEST')"
                      (click)="editRequest(request)" tooltip="{{langService.map.btn_edit}}"
                      class="icon-btn text-primary">
                <i class="mdi mdi-book-edit"></i>
              </button>
              <button *ngIf="empService.checkPermissions('EDIT_SUBVENTION_REQUEST')"
                      (click)="cancelRequest(request)" tooltip="{{langService.map.btn_cancel}}"
                      class="btn icon-btn text-primary">
                <i class="mdi mdi-book-cancel"></i>
              </button>
              <button *ngIf="request.isUnderProcessing()"
                      (click)="deleteRequest(request)" tooltip="{{langService.map.btn_delete}}"
                      class="btn icon-btn text-primary">
                <i class="mdi mdi-trash-can"></i>
              </button>
            </div>
          </td>
        </tr>
      </ng-container>
      </tbody>
    </table>
  </div>
</div>
