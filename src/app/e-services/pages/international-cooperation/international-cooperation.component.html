<div class="d-flex flex-column">
  <div *ngIf="!accordionView && !fromDialog" class="row mb-3">
    <div class="col"><h1 class="h6 text-primary">{{lang.map.menu_international_cooperation}}</h1></div>
  </div>
  <tabs-list class="py-4">
    <tab [name]="tabsData.basicInfo.name" [hasError]="getTabInvalidStatus('basicInfo')"
         [template]="basicInfoTabTemplate" [title]="lang.map.lbl_basic_info"></tab>
    <tab [name]="tabsData.comments.name" [hasError]="getTabInvalidStatus('comments')"
         [template]="commentsTabTemplate" [title]="lang.map.comments"
         *ngIf="employeeService.isInternalUser()"></tab>
    <tab [name]="tabsData.attachments.name" [hasError]="getTabInvalidStatus('attachments')"
         [template]="attachmentsTabTemplate" [title]="lang.map.attachments"></tab>
    <tab [name]="tabsData.recommendations.name" [hasError]="getTabInvalidStatus('recommendations')"
         [template]="recommendationsTemplate" [title]="lang.map.recommendations"
         *ngIf="fromDialog && employeeService.isInternalUser()" [disabled]="!model?.id"></tab>
  </tabs-list>

  <ng-template #basicInfoTabTemplate>
    <fieldset [disabled]="readonly">
      <form [formGroup]="form" autocomplete="off">
        <div class="row mb-3">
          <div class="col-md-6 col-sm-12">
            <div class="row">
              <label asteriskIfRequired="competentDepartmentID" for="competentDepartmentID"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.competent_dep}}</label>
              <div class="col-md-8 col-sm-12 mb-3 position-relative ng-select-wrapper">
                <ng-select [readonly]="readonly" (change)="onCompetentDepChange($event)"
                           validationClasses="competentDepartmentID"
                           formControlName="competentDepartmentID"
                           id="competentDepartmentID">
                  <ng-option [value]="department.id" [disabled]="!department.isActive()"
                             *ngFor="let department of departments">{{department.getName()}}</ng-option>
                </ng-select>
                <app-field-error-message controlName="competentDepartmentID"></app-field-error-message>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-sm-12">
            <div class="row">
              <label asteriskIfRequired="country" for="country"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.country}}</label>
              <div class="col-md-8 col-sm-12 mb-3 position-relative ng-select-wrapper">
                <ng-select [readonly]="readonly" validationClasses="country"
                           formControlName="country"
                           id="country">
                  <ng-option [value]="option.id" *ngFor="let option of countries"
                             [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
                </ng-select>
                <app-field-error-message controlName="country"></app-field-error-message>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-sm-12 col-md-6">
            <div class="row">
              <label for="fullName" asteriskIfRequired="fullName"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.full_name}}</label>
              <div class="col-md-8 mb-3 col-sm-12 position-relative">
                <input id="fullName" validationClasses="fullName" name="fullName" formControlName="fullName"
                       class="form-control">
                <app-field-error-message controlName="fullName"></app-field-error-message>
              </div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6">
            <div class="row">
              <label for="email" asteriskIfRequired="email"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.lbl_email}}</label>
              <div class="col-md-8 mb-3 col-sm-12 position-relative">
                <input id="email" validationClasses="email" name="email" formControlName="email"
                       class="form-control">
                <app-field-error-message controlName="email"></app-field-error-message>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-sm-12 col-md-6">
            <div class="row">
              <label for="organization" asteriskIfRequired="organization"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.lbl_organization}}</label>
              <div class="col-md-8 mb-3 col-sm-12 position-relative">
                <input id="organization" validationClasses="organization" name="organization"
                       formControlName="organization"
                       class="form-control">
                <app-field-error-message controlName="organization"></app-field-error-message>
              </div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6">
            <div class="row">
              <label for="mobileNo" asteriskIfRequired="mobileNo"
                     class="col-md-4 col-sm-12 col-form-label">{{lang.map.mobile_number}}</label>
              <div class="col-md-8 mb-3 col-sm-12 position-relative">
                <input id="mobileNo" validationClasses="mobileNo" name="mobileNo" formControlName="mobileNo"
                       class="form-control">
                <app-field-error-message controlName="mobileNo"></app-field-error-message>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <label asteriskIfRequired="requestBody" for="requestBody"
                 class="col-md-2 col-sm-12 col-form-label">{{lang.map.request_body}}</label>
          <div class="col-md-10 col-sm-12 mb-3 position-relative">
          <textarea rows="5" id="requestBody" formControlName="requestBody" validationClasses="requestBody"
                    class="form-control"></textarea>
            <app-field-error-message controlName="requestBody"></app-field-error-message>
          </div>
        </div>
      </form>
    </fieldset>
  </ng-template>

  <ng-template #commentsTabTemplate>
    <div class="d-flex flex-row align-items-center justify-content-start">
      <button [disabled]="!isAddCommentAllowed()" (click)="commentsCtrl.openCommentDialog()"
              class="d-inline-block btn p-0 icon-btn"><i
        class="mdi mdi-plus-box text-primary"></i></button>
    </div>
    <app-comments #commentsCtrl [caseId]="model?.id" [service]="service.commentService"
                  [readonly]="readonly"></app-comments>
  </ng-template>

  <ng-template #attachmentsTabTemplate>
    <div class="d-flex flex-row align-items-center justify-content-start">
      <button [disabled]="isAttachmentReadonly()" (click)="attachmentsCtrl.openUploadDialog()"
              class="d-inline-block btn p-0 icon-btn"><i
        class="mdi mdi-plus-box text-primary"></i></button>
    </div>
    <app-documents #attachmentsCtrl [caseId]="model?.id" [service]="service.documentService"
                   [readonly]="isAttachmentReadonly()"></app-documents>
  </ng-template>

  <ng-template #recommendationsTemplate>
    <app-recommendations [gridStyle]="false"
                         [disabled]="!allowEditRecommendations"
                         [case]="model"
                         [caseId]="model?.id"
                         [service]="service.recommendationService"></app-recommendations>
  </ng-template>
</div>
