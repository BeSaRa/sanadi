<div class="d-flex flex-column">
  <fieldset [disabled]="readonly">
    <form [formGroup]="form" autocomplete="off">
      <div class="row mb-3">
        <div class="col-md-6 col-sm-12">
          <div class="row">
            <label asteriskIfRequired="competentDepartmentID" for="competentDepartmentID"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.competent_dep}}</label>
            <div class="col-md-8 col-sm-12 mb-3 position-relative ng-select-wrapper">
              <ng-select [readonly]="readonly" (change)="onCompetentDepChange($event)"
                         validationClasses="competentDepartmentID"
                         formControlName="competentDepartmentID"
                         id="competentDepartmentID">
                <ng-option [value]="department.id"
                           *ngFor="let department of departments">{{department.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="competentDepartmentID"></app-field-error-message>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-sm-12">
          <div class="row">
            <label asteriskIfRequired="country" for="country"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.country}}</label>
            <div class="col-md-8 col-sm-12 mb-3 position-relative ng-select-wrapper">
              <ng-select [readonly]="readonly" validationClasses="country"
                         formControlName="country"
                         id="country">
                <ng-option [value]="option.id" *ngFor="let option of countries"
                           [disabled]="!option.isActive()">{{option.getName()}}</ng-option>
              </ng-select>
              <app-field-error-message controlName="country"></app-field-error-message>
            </div>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-sm-12 col-md-6">
          <div class="row">
            <label for="fullName" asteriskIfRequired="fullName"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.full_name}}</label>
            <div class="col-md-8 mb-3 col-sm-12 position-relative">
              <input id="fullName" validationClasses="fullName" name="fullName" formControlName="fullName"
                     class="form-control">
              <app-field-error-message controlName="fullName"></app-field-error-message>
            </div>
          </div>
        </div>
        <div class="col-sm-12 col-md-6">
          <div class="row">
            <label for="email" asteriskIfRequired="email"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.lbl_email}}</label>
            <div class="col-md-8 mb-3 col-sm-12 position-relative">
              <input id="email" validationClasses="email" name="email" formControlName="email"
                     class="form-control">
              <app-field-error-message controlName="email"></app-field-error-message>
            </div>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-sm-12 col-md-6">
          <div class="row">
            <label for="organization" asteriskIfRequired="organization"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.lbl_organization}}</label>
            <div class="col-md-8 mb-3 col-sm-12 position-relative">
              <input id="organization" validationClasses="organization" name="organization"
                     formControlName="organization"
                     class="form-control">
              <app-field-error-message controlName="organization"></app-field-error-message>
            </div>
          </div>
        </div>
        <div class="col-sm-12 col-md-6">
          <div class="row">
            <label for="mobileNo" asteriskIfRequired="mobileNo"
                   class="col-md-4 col-sm-12 col-form-label">{{lang.map.mobile_number}}</label>
            <div class="col-md-8 mb-3 col-sm-12 position-relative">
              <input id="mobileNo" validationClasses="mobileNo" name="mobileNo" formControlName="mobileNo"
                     class="form-control">
              <app-field-error-message controlName="mobileNo"></app-field-error-message>
            </div>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <label asteriskIfRequired="requestBody" for="requestBody"
               class="col-md-2 col-sm-12 col-form-label">{{lang.map.request_body}}</label>
        <div class="col-md-10 col-sm-12 mb-3 position-relative">
          <textarea rows="5" id="requestBody" formControlName="requestBody" validationClasses="requestBody"
                    class="form-control"></textarea>
          <app-field-error-message controlName="requestBody"></app-field-error-message>
        </div>
      </div>
    </form>
  </fieldset>
  <div *ngIf="fromDialog" class="row">
    <hr>
    <div class="col-md-12">
      <app-recommendations [gridStyle]="false"
                           [disabled]="!allowEditRecommendations"
                           [case]="model"
                           [caseId]="model?.id"
                           [service]="service.recommendationService"></app-recommendations>
    </div>
  </div>
  <hr>
  <div class="row">
    <div [ngClass]="{'col-md-12': employeeService.isExternalUser()}" class="col-md-6 col-sm-12">
      <div class="d-flex flex-row align-items-center justify-content-start">
        <h6 class="text-primary d-inline-block">{{lang.map.attachments}}</h6>
        <button [disabled]="!model?.id" (click)="attachmentsCtrl.openUploadDialog()"
                class="d-inline-block btn p-0 icon-btn"><i
          class="mdi mdi-plus-box text-primary"></i></button>
      </div>
      <app-documents #attachmentsCtrl [caseId]="model?.id" [service]="service.documentService"></app-documents>
    </div>
    <div *ngIf="employeeService.isInternalUser()" class="col-md-6 col-sm-12">
      <div class="d-flex flex-row align-items-center justify-content-start">
        <h6 class="text-primary d-inline-block">{{lang.map.comments}}</h6>
        <button [disabled]="!model?.id" (click)="commentsCtrl.openCommentDialog()"
                class="d-inline-block btn p-0 icon-btn"><i
          class="mdi mdi-plus-box text-primary"></i></button>
      </div>
      <app-comments #commentsCtrl [caseId]="model?.id" [service]="service.commentService"></app-comments>
    </div>
  </div>
</div>
