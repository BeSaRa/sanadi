<div class="dialog-toolbar bg-primary dialog-toolbar d-flex justify-content-between">
  <h1 class="h6 text-white">{{ lang.map[title] }}</h1>
  <button type="button" class="btn-close btn-close-white" tabindex="-1" dialogClose aria-label="Close"></button>
</div>
<div class="dialog-content no-fixed-height">
  <form [formGroup]="form">
    <div class="row">
      <!-- ar name -->
      <div class="col-sm-6 col-md-3 mb-4 position-relative">
        <label asteriskIfRequired="arName" for="arName" class="form-label">{{ lang.map.lbl_arabic_name
          }}</label>
        <input id="arName" validationClasses="arName" formControlName="arName" class="form-control" />
        <app-field-error-message controlName="arName"></app-field-error-message>
      </div>
      <!-- en nam -->
      <div class="col-sm-6 col-md-3 mb-4 position-relative">
        <label asteriskIfRequired="enName" for="enName" class="form-label">{{ lang.map.lbl_english_name
          }}</label>
        <input id="enName" validationClasses="enName" formControlName="enName" class="form-control" />
        <app-field-error-message controlName="enName"></app-field-error-message>
      </div>
      <!-- main cat -->
      <div class="col-sm-6 col-md-3 mb-4 position-relative">
        <label for="mainClass" asteriskIfRequired="mainClass" class="form-label">{{lang.map.classification}}</label>
        <ng-select validationClasses="type" (change)="loadSubClasses($event)" labelForId="mainClass"
          placeholder="{{lang.map.select}}" [notFoundText]="lang.map.msg_not_found" formControlName="mainClass"
          id="mainClass" appendTo="body">
          <ng-option *ngFor="let option of mainClassificationsList" [value]="option.id">
            {{option.getName()}}
          </ng-option>
        </ng-select>
        <app-field-error-message controlName="mainClass"></app-field-error-message>
      </div>
      <!-- sub cat -->
      <div class="col-sm-6 col-md-3 mb-4 position-relative">
        <label for="subClass" asteriskIfRequired="subClass" class="form-label">{{lang.map.sub_classification}}</label>
        <ng-select validationClasses="type" labelForId="subClass" placeholder="{{lang.map.select}}"
          [notFoundText]="lang.map.msg_not_found" formControlName="subClass" id="subClass" appendTo="body">
          <ng-option *ngFor="let option of subClassificationsList" [value]="option.id">
            {{option.getName()}}
          </ng-option>
        </ng-select>
        <app-field-error-message controlName="subClass"></app-field-error-message>
      </div>
      <!-- department -->
      <div class="col-sm-6 col-md-4 mb-4 position-relative">
        <label for="departmentId" asteriskIfRequired="departmentId" class="form-label">{{lang.map.department}}</label>
        <ng-select validationClasses="type" labelForId="departmentId" placeholder="{{lang.map.select}}"
          [notFoundText]="lang.map.msg_not_found" formControlName="departmentId" (change)="handleDepartmentChange()"
          id="departmentId" appendTo="body">
          <ng-option *ngFor="let option of departmentList" [value]="option.id">
            {{option.getName()}}
          </ng-option>
        </ng-select>
        <app-field-error-message controlName="departmentId"></app-field-error-message>
      </div>
      <!-- team -->
      <div class="col-sm-6 col-md-4 mb-4 position-relative">
        <label for="teamId" asteriskIfRequired="teamId" class="form-label">{{lang.map.lbl_main_team}}</label>
        <ng-select validationClasses="type" labelForId="teamId" placeholder="{{lang.map.select}}"
          [notFoundText]="lang.map.msg_not_found" (change)="handleTeamChange($event)" formControlName="teamId"
          id="teamId" appendTo="body">
          <ng-option *ngFor="let option of teamsList" [value]="option.id">
            {{option.getName()}}
          </ng-option>
        </ng-select>
        <app-field-error-message controlName="teamId"></app-field-error-message>
      </div>
      <!-- sub team -->
      <div class="col-sm-6 col-md-4 mb-4 position-relative">
        <label for="subTeamId" asteriskIfRequired="subTeamId" class="form-label">{{lang.map.lbl_sub_team}}</label>
        <ng-select validationClasses="type" labelForId="subTeamId" placeholder="{{lang.map.select}}"
          [notFoundText]="lang.map.msg_not_found" formControlName="subTeamId" id="subTeamId" appendTo="body">
          <ng-option *ngFor="let option of subTeamsList" [value]="option.id">
            {{option.getName()}}
          </ng-option>
        </ng-select>
        <app-field-error-message controlName="subTeamId"></app-field-error-message>
      </div>
    </div>
  </form>
  <hr>
  <form [formGroup]="fieldForm">
    <div class="row">
      <div class="col-12">
        <div class="row">
          <div class="col-12 col-lg-3 border-end" style="min-width: 300px;">
            <h6 class="title mb-3">{{ lang.map.lbl_add_template_field }}</h6>
            <div class="row">
              <!-- identifying name -->
              <div class="col-12 col-md-6 col-lg-12 mb-4 position-relative">
                <label asteriskIfRequired="identifyingName" for="identifyingName" class="form-label">{{
                  lang.map.lbl_identifying_name}}</label>
                <input id="identifyingName" formControlName="identifyingName" validationClasses="identifyingName"
                  class="form-control" />
                <app-field-error-message controlName="identifyingName"></app-field-error-message>
              </div>
              <!-- ar name -->
              <div class="col-12 col-md-6 col-lg-12 mb-4 position-relative">
                <label asteriskIfRequired="arName" for="fieldArName" class="form-label">{{ lang.map.lbl_arabic_name
                  }}</label>
                <input id="fieldArName" formControlName="arName" validationClasses="arName" class="form-control" />
                <app-field-error-message controlName="arName"></app-field-error-message>
              </div>
              <!-- en nam -->
              <div class="col-12 col-md-6 col-lg-12 mb-4 position-relative">
                <label asteriskIfRequired="enName" for="fieldEnName" class="form-label">{{ lang.map.lbl_english_name
                  }}</label>
                <input id="fieldEnName" formControlName="enName" validationClasses="enName" class="form-control" />
                <app-field-error-message controlName="enName"></app-field-error-message>
              </div>
              <!-- field type -->
              <div class="col-12 col-md-6 col-lg-12 mb-4 position-relative">
                <label for="fieldType" asteriskIfRequired="fieldType"
                  class="form-label">{{lang.map.lbl_field_type}}</label>
                <ng-select validationClasses="type" labelForId="fieldType" placeholder="{{lang.map.select}}"
                  [notFoundText]="lang.map.msg_not_found" formControlName="fieldType" id="fieldType" appendTo="body">
                  <ng-option *ngFor="let option of generalProcessTemplateFieldTypesList; let i = index;"
                    [value]="i + 1">
                    {{ getLabel(option) }}
                  </ng-option>
                </ng-select>
                <app-field-error-message controlName="fieldType"></app-field-error-message>
              </div>
              <div class="col-12 col-md-6 col-lg-12">
                <div class="row">
                  <!-- order -->
                  <div class="col mb-4 position-relative">
                    <label asteriskIfRequired="order" for="order" class="form-label">{{ lang.map.lbl_field_order
                      }}</label>
                    <input id="order" validationClasses="order" [mask]="inputMaskPatterns.NUMBER_ONLY"
                      formControlName="order" class="form-control" />
                    <app-field-error-message controlName="order"></app-field-error-message>
                  </div>
                  <!-- is required -->
                  <div class="mb-4 position-relative" style="max-width: 100px;">
                    <label for="isRquired" class="form-label">{{lang.map.lbl_required}}</label>
                    <input class="form-check-input" formControlName="isRquired" type="checkbox">
                  </div>
                </div>
              </div>
              <!-- regex -->
              <div class="col-12 col-md-6 col-lg-12 mb-4 position-relative">
                <label asteriskIfRequired="regex" for="regex" class="form-label">{{ lang.map.lbl_regex}}</label>
                <input id="regex" validationClasses="regex" formControlName="regex" class="form-control" />
                <app-field-error-message controlName="regex"></app-field-error-message>
              </div>
              <!-- note -->
              <div class="col-sm-12 mb-4 position-relative">
                <label class="form-label" asteriskIfRequired="note" for="note">{{lang.map.notes}}</label>
                <textarea name="note" validationClasses="note" id="note" formControlName="note" rows="4"
                  class="form-control"></textarea>
                <app-field-error-message controlName="note"></app-field-error-message>
              </div>
              <div class="col-12">
                <button class="btn btn-primary me-2" [disabled]="!this.fieldForm.valid" (click)="addField()">
                  {{ lang.map.btn_save }}
                </button>
                <button class="btn btn-secondary" (click)="resetFieldForm()">
                  {{ lang.map.btn_clear }}
                </button>
              </div>
            </div>
          </div>
          <div class="col">
            <h6 class="title mb-3">{{ lang.map.lbl_template }}</h6>
            <formly-form [fields]="fields"></formly-form>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
<div class="dialog-actions">
  <button class="btn btn-primary" [disabled]="form.invalid" *ngIf="saveVisible" (click)="save$.next(null)" dialogClose>
    {{ lang.map.btn_save }}
  </button>
  <button dialogClose class="btn btn-secondary">
    {{ lang.map.btn_close }}
  </button>
</div>
