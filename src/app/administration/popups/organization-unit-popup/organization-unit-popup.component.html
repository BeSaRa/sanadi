<div class="dialog-toolbar bg-primary d-flex justify-content-between">
  <h1 class="h6 text-white">{{popupTitle}}</h1>
  <button type="button" class="btn-close btn-close-white"
          tabindex="-1" [dialogClose]="model" aria-label="Close"></button>
</div>
<div class="dialog-content" #dialogContent>
  <form [formGroup]="form" novalidate autocomplete="off">
    <tabs-list (onTabChange)="setDialogButtonsVisibility($event)">
      <tab [name]="tabsData.basic.name" [hasError]="getTabInvalidStatus('basic')"
           [template]="basicInfoTemplate" [tabWidth]="'600px'"
           [title]="langService.map.lbl_basic_info"></tab>
      <tab [name]="tabsData.advanced.name" [hasError]="getTabInvalidStatus('advanced')"
           [template]="advancedInfoTemplate" [tabWidth]="'600px'"
           [title]="langService.map.advanced"></tab>
      <tab [name]="tabsData.services.name" [template]="servicesTemplate"
           *ngIf="model.id" [title]="langService.map.link_services" [tabWidth]="'600px'"></tab>
      <tab [name]="tabsData.branches.name" [template]="branchesTemplate"
           *ngIf="model.id" [title]="langService.map.lbl_org_branches"></tab>
    </tabs-list>
    <ng-template #basicInfoTemplate>
      <div formGroupName="basic">
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="arName" for="arName"
                   class="form-label">{{langService.map.lbl_arabic_name}}</label>
            <input id="arName" validationClasses="arName" trimInput
                   formControlName="arName" class="form-control">
            <app-field-error-message controlName="arName"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="enName" for="enName"
                   class="form-label">{{langService.map.lbl_english_name}}</label>
            <input id="enName" validationClasses="enName" trimInput
                   formControlName="enName" class="form-control">
            <app-field-error-message controlName="enName"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="orgUnitType" asteriskIfRequired="orgUnitType"
                   class="form-label">{{langService.map.lbl_org_unit_type}}</label>
            <ng-select [selectOnTab]="true" labelForId="orgUnitType" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="orgUnitType"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="orgUnitType" appendTo="body"
                       validationClasses="orgUnitType">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of orgUnitTypesList" [value]="option.lookupKey">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="orgUnitType"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="orgCode" for="orgCode"
                   class="form-label">{{langService.map.lbl_org_unit_code}}</label>
            <input id="orgCode" validationClasses="orgCode" trimInput
                   formControlName="orgCode" class="form-control">
            <app-field-error-message controlName="orgCode"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="status" asteriskIfRequired="status" class="form-label">{{langService.map.lbl_status}}</label>
            <ng-select [selectOnTab]="true" labelForId="status" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="status"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="status" appendTo="body"
                       validationClasses="status">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of orgUnitStatusList" [value]="option.lookupKey"
                         [disabled]="option.isRetiredOrgStatus()">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="status"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="email" for="email" class="form-label">{{langService.map.lbl_email}}</label>
            <input id="email" validationClasses="email" trimInput
                   formControlName="email" class="form-control">
            <app-field-error-message controlName="email"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="phoneNumber1" asteriskIfRequired="phoneNumber1"
                   class="form-label">{{langService.map.lbl_phone_1}}</label>
            <input id="phoneNumber1" validationClasses="phoneNumber1"
                   formControlName="phoneNumber1" class="form-control" [mask]="inputMaskPatterns.NUMBER_ONLY">
            <app-field-error-message controlName="phoneNumber1"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="phoneNumber2" class="form-label">{{langService.map.lbl_phone_2}}</label>
            <input id="phoneNumber2" validationClasses="phoneNumber2"
                   formControlName="phoneNumber2" class="form-control" [mask]="inputMaskPatterns.NUMBER_ONLY">
            <app-field-error-message controlName="phoneNumber2"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative">
            <label for="address" class="form-label">{{langService.map.lbl_address}}</label>
            <textarea id="address" validationClasses="address" trimInput
                      formControlName="address" class="form-control">
            </textarea>
            <app-field-error-message controlName="address"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="buildingName" for="buildingName"
                   class="form-label">{{langService.map.lbl_building_name}}</label>
            <input id="buildingName" validationClasses="buildingName" trimInput
                   formControlName="buildingName" class="form-control">
            <app-field-error-message controlName="buildingName"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="unitName" for="unitName"
                   class="form-label">{{langService.map.lbl_unit_name}}</label>
            <input id="unitName" validationClasses="unitName" trimInput
                   formControlName="unitName" class="form-control">
            <app-field-error-message controlName="unitName"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="street" for="street" class="form-label">{{langService.map.lbl_street}}</label>
            <input id="street" validationClasses="street" trimInput
                   formControlName="street" class="form-control">
            <app-field-error-message controlName="street"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label asteriskIfRequired="zone" for="zone" class="form-label">{{langService.map.lbl_zone}}</label>
            <input id="zone" validationClasses="zone" trimInput
                   formControlName="zone" class="form-control">
            <app-field-error-message controlName="zone"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="city" asteriskIfRequired="city"
                   class="form-label">{{langService.map.city}}</label>
            <ng-select [selectOnTab]="true" labelForId="city" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="city"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="city" appendTo="body"
                       validationClasses="city">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of cityList" [value]="option.lookupKey">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="city"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="poBoxNum" class="form-label">{{langService.map.lbl_po_box_num}}</label>
            <input id="poBoxNum" validationClasses="poBoxNum"
                   formControlName="poBoxNum" class="form-control" [mask]="inputMaskPatterns.NUMBER_ONLY">
            <app-field-error-message controlName="poBoxNum"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="faxNumber" asteriskIfRequired="faxNumber"
                   class="form-label">{{langService.map.fax_number}}</label>
            <input id="faxNumber" validationClasses="faxNumber"
                   formControlName="faxNumber" class="form-control" [mask]="inputMaskPatterns.NUMBER_ONLY">
            <app-field-error-message controlName="faxNumber"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="hotLine" asteriskIfRequired="hotLine"
                   class="form-label">{{langService.map.hotline}}</label>
            <input id="hotLine" validationClasses="hotLine"
                   formControlName="hotLine" class="form-control" [mask]="inputMaskPatterns.NUMBER_ONLY">
            <app-field-error-message controlName="hotLine"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="registryCreator" asteriskIfRequired="registryCreator"
                   class="form-label">{{langService.map.registered_by}}</label>
            <ng-select [selectOnTab]="true" labelForId="registryCreator" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="registryCreator"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="registryCreator" appendTo="body"
                       validationClasses="registryCreator">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of orgUnitsList" [value]="option.id">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="registryCreator"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="registryDate" asteriskIfRequired="registryDate"
                   class="form-label">{{langService.map.first_registration_date}}</label>
            <div class="input-group">
              <i class="input-group-text mdi mdi-calendar"></i>
              <div class="form-control" formControlName="registryDate"
                   id="registryDate" [options]="datepickerOptionsMap.registryDate"
                   (click)="dpRegistryDate.toggleCalendar()" #dpRegistryDate="angular-mydatepicker"
                   angular-mydatepicker validationClasses="registryDate"></div>
              <app-field-error-message controlName="registryDate"></app-field-error-message>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="workField" asteriskIfRequired="workField"
                   class="form-label">{{langService.map.work_field}}</label>
            <ng-select [selectOnTab]="true" labelForId="workField" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="workField"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="workField" appendTo="body"
                       validationClasses="workField">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of workFieldList" [value]="option.lookupKey">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="workField"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="licensingAuthority" asteriskIfRequired="orgFieldId"
                   class="form-label">{{langService.map.organization_field}}</label>
            <ng-select [selectOnTab]="true" labelForId="orgFieldId" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="orgFieldId"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="orgFieldId" appendTo="body"
                       validationClasses="orgFieldId">
              <ng-option *ngFor="let option of orgUnitFieldList" [value]="option.id">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="orgFieldId"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative ng-select-wrapper">
            <label for="licensingAuthority" asteriskIfRequired="licensingAuthority"
                   class="form-label">{{langService.map.licensing_authority}}</label>
            <ng-select [selectOnTab]="true" labelForId="licensingAuthority" [clearable]="false"
                       placeholder="{{langService.map.select}}" id="licensingAuthority"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="licensingAuthority" appendTo="body"
                       validationClasses="licensingAuthority">
              <ng-option value="">{{langService.map.lbl_none}}</ng-option>
              <ng-option *ngFor="let option of licensingAuthorityList" [value]="option.lookupKey">
                {{option.getName()}}
              </ng-option>
            </ng-select>
            <app-field-error-message controlName="licensingAuthority"></app-field-error-message>
          </div>
          <div class="col-sm-6 mt-5 form-check form-switch">
            <div class="ms-3">
              <input class="form-check-input" type="checkbox" id="promoteExtProj" formControlName="promoteExtProj">
              <label class="form-check-label"
                     for="promoteExtProj">{{langService.map.promotion_of_external_projects}}</label>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
    <ng-template #advancedInfoTemplate style="width: 600px">
      <div formGroupName="advanced">
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="unifiedEconomicRecord" class="form-label">{{langService.map.unified_economic_record}}</label>
            <input id="unifiedEconomicRecord" validationClasses="unifiedEconomicRecord" trimInput
                   formControlName="unifiedEconomicRecord" class="form-control">
            <app-field-error-message controlName="unifiedEconomicRecord"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="webSite" class="form-label">{{langService.map.website}}</label>
            <input id="webSite" validationClasses="webSite" trimInput formControlName="webSite" class="form-control">
            <app-field-error-message controlName="webSite"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="establishmentDate" class="form-label">{{langService.map.establishment_date}}</label>
            <div class="input-group">
              <i class="input-group-text mdi mdi-calendar"></i>
              <div class="form-control" formControlName="establishmentDate"
                   id="establishmentDate" [options]="datepickerOptionsMap.establishmentDate"
                   (click)="dpEstablishmentDate.toggleCalendar()" #dpEstablishmentDate="angular-mydatepicker"
                   angular-mydatepicker validationClasses="establishmentDate"></div>
              <app-field-error-message controlName="establishmentDate"></app-field-error-message>
            </div>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="budgetClosureDate" class="form-label">{{langService.map.budget_closure_date}}</label>
            <div class="input-group">
              <i class="input-group-text mdi mdi-calendar"></i>
              <div class="form-control" formControlName="budgetClosureDate"
                   id="budgetClosureDate" [options]="datepickerOptionsMap.budgetClosureDate"
                   (click)="dpBudgetClosureDate.toggleCalendar()" #dpBudgetClosureDate="angular-mydatepicker"
                   angular-mydatepicker validationClasses="budgetClosureDate"></div>
              <app-field-error-message controlName="budgetClosureDate"></app-field-error-message>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="registryNumber" class="form-label">{{langService.map.registry_number}}</label>
            <input id="registryNumber" validationClasses="registryNumber" trimInput
                   formControlName="registryNumber" class="form-control">
            <app-field-error-message controlName="registryNumber"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="orgUnitAuditor" class="form-label">{{langService.map.auditor}}</label>
            <input id="orgUnitAuditor" validationClasses="orgUnitAuditor" trimInput
                   formControlName="orgUnitAuditor" class="form-control">
            <app-field-error-message controlName="orgUnitAuditor"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="linkToInternalSystem" class="form-label">{{langService.map.link_to_internal_system}}</label>
            <input id="linkToInternalSystem" validationClasses="linkToInternalSystem" trimInput
                   formControlName="linkToInternalSystem" class="form-control">
            <app-field-error-message controlName="linkToInternalSystem"></app-field-error-message>
          </div>
          <div class="col-sm-6 mb-4 position-relative">
            <label for="lawSubjectedName" class="form-label">{{langService.map.law_subjected_name}}</label>
            <input id="lawSubjectedName" validationClasses="lawSubjectedName" trimInput
                   formControlName="lawSubjectedName" class="form-control">
            <app-field-error-message controlName="lawSubjectedName"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 mb-4 position-relative">
            <label for="boardDirectorsPeriod" class="form-label">{{langService.map.board_of_directors_period}}</label>
            <input id="boardDirectorsPeriod" validationClasses="boardDirectorsPeriod" trimInput
                   formControlName="boardDirectorsPeriod" class="form-control">
            <app-field-error-message controlName="boardDirectorsPeriod"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative ng-select-wrapper">
            <label for="arabicBoardMembers" asteriskIfRequired="arabicBoardMembers"
                   class="form-label">{{langService.map.arabic_board_members}}</label>
            <ng-select [selectOnTab]="true" labelForId="arabicBoardMembers" [clearable]="false"
                       id="arabicBoardMembers"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="arabicBoardMembers"
                       [items]="arabicBoardMembersField?.value"
                       [addTag]="addArabicBoardMembers"
                       [multiple]="true"
                       [isOpen]="false"
                       class="no-dropdown"
                       validationClasses="arabicBoardMembers">
            </ng-select>
            <app-field-error-message controlName="arabicBoardMembers"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative ng-select-wrapper">
            <label for="enBoardMembers" asteriskIfRequired="enBoardMembers"
                   class="form-label">{{langService.map.english_board_members}}</label>
            <ng-select [selectOnTab]="true" labelForId="enBoardMembers" [clearable]="false"
                       id="enBoardMembers"
                       [notFoundText]="langService.map.msg_not_found"
                       formControlName="enBoardMembers"
                       [items]="englishBoardMembersField?.value"
                       [addTag]="addEnglishBoardMembers"
                       [multiple]="true"
                       [isOpen]="false"
                       class="no-dropdown"
                       validationClasses="enBoardMembers">
            </ng-select>
            <app-field-error-message controlName="enBoardMembers"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative">
            <label for="arabicBrief" class="form-label">{{langService.map.arabic_brief}}</label>
            <textarea id="arabicBrief" cols="3" validationClasses="arabicBrief" trimInput
                      formControlName="arabicBrief" class="form-control"></textarea>
            <app-field-error-message controlName="arabicBrief"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 mb-4 position-relative">
            <label for="enBrief" class="form-label">{{langService.map.english_brief}}</label>
            <textarea id="enBrief" cols="3" validationClasses="enBrief" trimInput
                      formControlName="enBrief" class="form-control"></textarea>
            <app-field-error-message controlName="enBrief"></app-field-error-message>
          </div>
        </div>
        <div class="row">
          <input type="file" #logoUploader [hidden]="true" (change)="onLogoSelected($event)"
                 [accept]="logoExtensions.join(',')">
          <div class="col-md-3 col-sm-12">
            <button class="btn btn-primary"
                    (click)="openFileBrowser($event)">
              {{langService.map.upload_logo}}
            </button>
          </div>
          <div class="col-md-9 col-sm-12">
            <img *ngIf="logoPath" id="orgLogo" src="{{logoPath}}" alt="{{langService.map.logo}}"
                 class="img-fit-contain mt-1"/>

            <button *ngIf="logoFile" class="btn icon-btn text-primary m-0 align-top"
                    tooltip="{{langService.map.btn_remove}}"
                    (click)="removeLogo($event)">
              <i class="mdi mdi-close"></i>
            </button>
          </div>
        </div>
      </div>
    </ng-template>
    <ng-template #servicesTemplate>
      <organization-unit-services [orgUnit]="model"></organization-unit-services>
    </ng-template>
    <ng-template #branchesTemplate>
      <app-organization-branch [organization]="model"></app-organization-branch>
    </ng-template>
  </form>
</div>
<div class="dialog-actions">
  <button tabindex="-1" *ngIf="validateFieldsVisible" (click)="displayFormValidity(null, dialogContent)"
          tooltip="{{langService.map.validate_fields}}" class="btn btn-link">
    <i class="mdi mdi-information-outline text-info"></i>
  </button>
  <span class="flex-grow-1"></span>
  <button [disabled]="form.invalid" *ngIf="saveVisible" (click)="save$.next(null)"
          class="btn btn-primary">{{langService.map.btn_save}}</button>
  <button [dialogClose]="model" class="btn btn-secondary">{{langService.map.btn_cancel}}</button>
</div>
